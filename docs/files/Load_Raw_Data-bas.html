<!DOCTYPE html>

<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>Load_Raw_Data.bas</title><link rel="stylesheet" type="text/css" href="../styles/main.css" /><script type="text/javascript" src="../styles/main.js"></script><script type="text/javascript">NDLoader.LoadJS("Content", "../styles/");</script></head>

<!-- Generated by Natural Docs, version 2.2 -->

<!-- saved from url=(0016)http://localhost -->

<body onload="NDLoader.OnLoad('Content');" class="NDPage NDContentPage">

<a name="Functions"></a><a name="Topic186"></a><div class="CTopic TGroup LVisualBasic first">
 <div class="CTitle">Functions</div>
</div>

<a name="Get_Transition_Array_Agilent_Compound"></a><a name="Topic187"></a><div class="CTopic TFunction LVisualBasic">
 <div class="CTitle">Get_Transition_Array_Agilent_Compound</div>
 <div id="NDPrototype187" class="NDPrototype WideForm"><div class="PSection PParameterSection CStyle"><table><tr><td class="PBeforeParameters">Public Function Get_Transition_Array_Agilent_Compound(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PModifierQualifier first">ByRef Transition_Array()&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName">String,</td><td></td><td class="last"></td></tr><tr><td class="PModifierQualifier first">ByRef Lines()&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName">String,</td><td></td><td class="last"></td></tr><tr><td class="PModifierQualifier first">ByRef Transition_Name_And_Qualifier_Transition_Column_Indexes()&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName">Long,</td><td></td><td class="last"></td></tr><tr><td class="PModifierQualifier first">ByVal DataStartRowNumber&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName">Long,</td><td></td><td class="last"></td></tr><tr><td class="PModifierQualifier first">ByVal Delimiter&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName">String,</td><td></td><td class="last"></td></tr><tr><td class="PModifierQualifier first">ByVal RemoveBlksAndReplicates&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName">Boolean,</td><td></td><td class="last"></td></tr><tr><td class="PModifierQualifier first">Optional ByVal IgnoreEmptyArray&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName">Boolean</td><td class="PDefaultValueSeparator">&nbsp;=&nbsp;</td><td class="PDefaultValue last">True</td></tr></table></td><td class="PAfterParameters">) As String()</td></tr></table></div></div>
 <div class="CBody"><pre class="CCode">Public Function Get_Transition_Array_Agilent_Compound(ByRef Transition_Array() As String, _<br />                                                      ByRef Lines() As String, _<br />                                                      ByRef Transition_Name_And_Qualifier_Transition_Column_Indexes() As Long, _<br />                                                      ByVal DataStartRowNumber As Long, _<br />                                                      ByVal Delimiter As String, _<br />                                                      ByVal RemoveBlksAndReplicates As Boolean, _<br />                                                      Optional ByVal IgnoreEmptyArray As Boolean = True) As String()</pre><div class="CHeading">Description</div><p>Get Transition Names from an input Agilent raw data file in compound table form and put them into a string array.</p><div class="CHeading">Parameters</div><div class="CHeading">Returns</div><p>A string array of Transition Names</p><div class="CHeading">Examples</div><pre class="CCode">Dim Transition_Array() As String<br />Dim TestFolder As String<br />Dim RawDataFile As String<br /><br /><span class="SHComment">' Indicate path to the test data folder</span><br />TestFolder = ThisWorkbook.Path &amp; <span class="SHString">&quot;\Testdata\&quot;</span><br /><span class="SHString">RawDataFile = TestFolder &amp; &quot;</span>CompoundTableForm_Qualifier.csv<span class="SHString">&quot;</span><br /><br /><span class="SHString">Dim Lines() As String</span><br /><span class="SHString">Lines = Utilities.Read_File(RawDataFile)</span><br /><br /><span class="SHString">Dim Transition_Name_And_Qualifier_Transition_Column_Indexes(3) As Long</span><br /><span class="SHString">Transition_Name_And_Qualifier_Transition_Column_Indexes(0) = 1</span><br /><span class="SHString">Transition_Name_And_Qualifier_Transition_Column_Indexes(1) = 10</span><br /><span class="SHString">Transition_Name_And_Qualifier_Transition_Column_Indexes(2) = 14</span><br /><span class="SHString">Transition_Name_And_Qualifier_Transition_Column_Indexes(3) = 18</span><br /><br /><span class="SHString">'Load the sample name and datafile name into the two arrays</span><br /><span class="SHString">Transition_Array = Load_Raw_Data.Get_Transition_Array_Agilent_Compound(Transition_Array:=Transition_Array, _</span><br /><span class="SHString">                                                                       Lines:=Lines, _</span><br /><span class="SHString">                                                                       Transition_Name_And_Qualifier_Transition_Column_Indexes:=Transition_Name_And_Qualifier_Transition_Column_Indexes, _</span><br /><span class="SHString">                                                                       DataStartRowNumber:=2, _</span><br /><span class="SHString">                                                                       Delimiter:=&quot;</span>,<span class="SHString">&quot;, _</span><br /><span class="SHString">                                                                       RemoveBlksAndReplicates:=True, _</span><br /><span class="SHString">                                                                       IgnoreEmptyArray:=True)</span></pre></div>
</div>

<a name="Get_Sample_Name_Array"></a><a name="Topic188"></a><div class="CTopic TFunction LVisualBasic">
 <div class="CTitle">Get_Sample_Name_Array</div>
 <div id="NDPrototype188" class="NDPrototype WideForm"><div class="PSection PParameterSection CStyle"><table><tr><td class="PBeforeParameters">Public Function Get_Sample_Name_Array(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PModifierQualifier first">ByRef RawDataFilesArray()&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName last">String,</td></tr><tr><td class="PModifierQualifier first">ByRef MS_File_Array()&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName last">String</td></tr></table></td><td class="PAfterParameters">) As String()</td></tr></table></div></div>
 <div class="CBody"><pre class="CCode">Public Function Get_Sample_Name_Array(ByRef RawDataFilesArray() As String, _<br />                                      ByRef MS_File_Array() As String) As String()</pre><div class="CHeading">Description</div><p>Get Sample Names from an input raw data file, put them into a string array.</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">RawDataFilesArray() As String</td><td class="CDLDefinition"><p>A string array of File path to a Raw Data (Agilent) File in csv.&nbsp; Eg. {FilePath 1, FilePath 2}</p></td></tr><tr><td class="CDLEntry">MS_File_Array() As String</td><td class="CDLDefinition"><p>A string array of Data File Names to be loaded to the Data_File_Name column of the Sample_Annot sheet. If this function is used more than once, this array will be appended.&nbsp; Eg. {Input_File_Name_1, Input_File_Name_1, Input_File_Name_2}</p></td></tr></table><div class="CHeading">Returns</div><p>A string array of Sample Names and a string array of Data File Names</p><div class="CHeading">Examples</div><pre class="CCode">Dim TestFolder As String<br />Dim RawDataFiles As String<br />Dim RawDataFilesArray() As String<br /><br />Dim MS_File_Array() As String<br />Dim Sample_Name_Array_from_Raw_Data() As String<br /><br /><span class="SHComment">' Indicate path to the test data folder</span><br />TestFolder = ThisWorkbook.Path &amp; <span class="SHString">&quot;\Testdata\&quot;</span><br /><span class="SHString">RawDataFiles = TestFolder &amp; &quot;</span>MultipleDataTest2.csv<span class="SHString">&quot;</span><br /><span class="SHString">RawDataFilesArray = Split(RawDataFiles, &quot;</span>;<span class="SHString">&quot;)</span><br /><br /><span class="SHString">'Load the sample name and datafile name into the two arrays</span><br /><span class="SHString">Sample_Name_Array_from_Raw_Data = Load_Raw_Data.Get_Sample_Name_Array(RawDataFilesArray:=RawDataFilesArray, _</span><br /><span class="SHString">                                                                      MS_File_Array:=MS_File_Array)</span></pre></div>
</div>

<a name="Get_Transition_Array_Raw"></a><a name="Topic189"></a><div class="CTopic TFunction LVisualBasic last">
 <div class="CTitle">Get_Transition_Array_Raw</div>
 <div id="NDPrototype189" class="NDPrototype WideForm"><div class="PSection PParameterSection CStyle"><table><tr><td class="PBeforeParameters">Public Function Get_Transition_Array_Raw(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PModifierQualifier first">ByVal RawDataFiles&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName last">String</td></tr></table></td><td class="PAfterParameters">) As String()</td></tr></table></div></div>
 <div class="CBody"><pre class="CCode">Public Function Get_Transition_Array_Raw(ByVal RawDataFiles As String) As String()</pre><div class="CHeading">Description</div><p>Get Transition Names from an input raw data file, put them into a string array.</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">RawDataFiles As String</td><td class="CDLDefinition"><p>File path to a Raw Data (Agilent) File in csv.&nbsp; If multiple files are required, the different file path must be separated by &quot;;&quot; Eg. {FilePath 1};{FilePath 2}</p></td></tr></table><div class="CHeading">Returns</div><p>A string array of Transition Names.</p><div class="CHeading">Examples</div><pre class="CCode">Dim TestFolder As String<br />Dim RawDataFiles As String<br />Dim Transition_Array() As String<br /><br /><span class="SHComment">' Indicate path to the test data folder</span><br />TestFolder = ThisWorkbook.Path &amp; <span class="SHString">&quot;\Testdata\&quot;</span><br /><span class="SHString">RawDataFiles = TestFolder &amp; &quot;</span>AgilentRawDataTest1.csv<span class="SHString">&quot;</span><br /><br /><span class="SHString">' Get the transition names</span><br /><span class="SHString">Transition_Array = Load_Raw_Data.Get_Transition_Array_Raw(RawDataFiles:=RawDataFiles)</span></pre></div>
</div>

</body></html>