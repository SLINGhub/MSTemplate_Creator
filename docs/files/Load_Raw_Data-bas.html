<!DOCTYPE html>

<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>Load_Raw_Data.bas</title><link rel="stylesheet" type="text/css" href="../styles/main.css" /><script type="text/javascript" src="../styles/main.js"></script><script type="text/javascript">NDLoader.LoadJS("Content", "../styles/");</script></head>

<!-- Generated by Natural Docs, version 2.2 -->

<!-- saved from url=(0016)http://localhost -->

<body onload="NDLoader.OnLoad('Content');" class="NDPage NDContentPage">

<a name="Functions"></a><a name="Topic163"></a><div class="CTopic TGroup LExcelVBA first">
 <div class="CTitle">Functions</div>
</div>

<a name="Get_Transition_Array_Agilent_Compound"></a><a name="Topic164"></a><div class="CTopic TFunction LExcelVBA">
 <div class="CTitle">Get_Transition_Array_Agilent_Compound</div>
 <div class="CBody"><div class="CHeading">Description</div><p>Get Transition Names from an input Agilent raw data file in compound table form and put them into a string array.</p><div class="CHeading">Parameters</div><div class="CHeading">Returns</div><p>A string array of Transition Names</p><div class="CHeading">Examples</div><pre class="CCode">Dim Transition_Array() As String<br />Dim TestFolder As String<br />Dim RawDataFile As String<br /><br /><span class="SHString">' Indicate path to the test data folder</span><br /><span class="SHString">TestFolder = ThisWorkbook.Path &amp; &quot;\Testdata\&quot;</span><br /><span class="SHString">RawDataFile = TestFolder &amp; &quot;CompoundTableForm_Qualifier.csv&quot;</span><br /><br /><span class="SHString">Dim Lines() As String</span><br /><span class="SHString">Lines = Utilities.Read_File(RawDataFile)</span><br /><br /><span class="SHString">Dim Transition_Name_And_Qualifier_Transition_Column_Indexes(3) As Long</span><br /><span class="SHString">Transition_Name_And_Qualifier_Transition_Column_Indexes(0) = 1</span><br /><span class="SHString">Transition_Name_And_Qualifier_Transition_Column_Indexes(1) = 10</span><br /><span class="SHString">Transition_Name_And_Qualifier_Transition_Column_Indexes(2) = 14</span><br /><span class="SHString">Transition_Name_And_Qualifier_Transition_Column_Indexes(3) = 18</span><br /><br /><span class="SHString">'</span>Load the sample name and datafile name into the two arrays<br />Transition_Array = Load_Raw_Data.Get_Transition_Array_Agilent_Compound(Transition_Array:=Transition_Array, _<br />                                                                       Lines:=Lines, _<br />                                                                       Transition_Name_And_Qualifier_Transition_Column_Indexes:=Transition_Name_And_Qualifier_Transition_Column_Indexes, _<br />                                                                       DataStartRowNumber:=<span class="SHNumber">2</span>, _<br />                                                                       Delimiter:=<span class="SHString">&quot;,&quot;</span>, _<br />                                                                       RemoveBlksAndReplicates:=True, _<br />                                                                       IgnoreEmptyArray:=True)</pre></div>
</div>

<a name="Get_Sample_Name_Array"></a><a name="Topic165"></a><div class="CTopic TFunction LExcelVBA">
 <div class="CTitle">Get_Sample_Name_Array</div>
 <div class="CBody"><div class="CHeading">Description</div><p>Get Sample Names from an input raw data file, put them into a string array.</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">RawDataFilesArray() As String</td><td class="CDLDefinition"><p>A string array of File path to a Raw Data (Agilent) File in csv.&nbsp; Eg. {FilePath 1, FilePath 2}</p></td></tr><tr><td class="CDLEntry">MS_File_Array() As String</td><td class="CDLDefinition"><p>A string array of Data File Names to be loaded to the Data_File_Name column of the Sample_Annot sheet. If this function is used more than once, this array will be appended.&nbsp; Eg. {Input_File_Name_1, Input_File_Name_1, Input_File_Name_2}</p></td></tr></table><div class="CHeading">Returns</div><p>A string array of Sample Names and a string array of Data File Names</p><div class="CHeading">Examples</div><pre class="CCode">Dim TestFolder As String<br />Dim RawDataFiles As String<br />Dim RawDataFilesArray() As String<br /><br />Dim MS_File_Array() As String<br />Dim Sample_Name_Array_from_Raw_Data() As String<br /><br /><span class="SHString">' Indicate path to the test data folder</span><br /><span class="SHString">TestFolder = ThisWorkbook.Path &amp; &quot;\Testdata\&quot;</span><br /><span class="SHString">RawDataFiles = TestFolder &amp; &quot;MultipleDataTest2.csv&quot;</span><br /><span class="SHString">RawDataFilesArray = Split(RawDataFiles, &quot;;&quot;)</span><br /><br /><span class="SHString">'</span>Load the sample name and datafile name into the two arrays<br />Sample_Name_Array_from_Raw_Data = Load_Raw_Data.Get_Sample_Name_Array(RawDataFilesArray:=RawDataFilesArray, _<br />                                                                      MS_File_Array:=MS_File_Array)</pre></div>
</div>

<a name="Get_Transition_Array_Raw"></a><a name="Topic166"></a><div class="CTopic TFunction LExcelVBA last">
 <div class="CTitle">Get_Transition_Array_Raw</div>
 <div class="CBody"><div class="CHeading">Description</div><p>Get Transition Names from an input raw data file, put them into a string array.</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">RawDataFiles As String</td><td class="CDLDefinition"><p>File path to a Raw Data (Agilent) File in csv.&nbsp; If multiple files are required, the different file path must be separated by &quot;;&quot; Eg. {FilePath 1};{FilePath 2}</p></td></tr></table><div class="CHeading">Returns</div><p>A string array of Transition Names.</p><div class="CHeading">Examples</div><pre class="CCode">Dim TestFolder As String<br />Dim RawDataFiles As String<br />Dim Transition_Array() As String<br /><br /><span class="SHString">' Indicate path to the test data folder</span><br /><span class="SHString">TestFolder = ThisWorkbook.Path &amp; &quot;\Testdata\&quot;</span><br /><span class="SHString">RawDataFiles = TestFolder &amp; &quot;AgilentRawDataTest1.csv&quot;</span><br /><br /><span class="SHString">'</span> Get the transition names<br />Transition_Array = Load_Raw_Data.Get_Transition_Array_Raw(RawDataFiles:=RawDataFiles)</pre></div>
</div>

</body></html>