<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">

<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Utilities.bas</title><link rel="stylesheet" type="text/css" href="../styles/main.css" /><script type="text/javascript" src="../styles/main.js"></script><script type="text/javascript">NDLoader.LoadJS("Content", "../styles/");</script></head>

<!-- Generated by Natural Docs, version 2.1.1 -->

<!-- saved from url=(0016)http://localhost -->

<body onload="NDLoader.OnLoad('Content');" class="NDPage NDContentPage">

<a name="Functions"></a><a name="Topic67"></a><div class="CTopic TGroup LExcelVBA first">
 <div class="CTitle">Functions</div>
</div>

<a name="Read_File"></a><a name="Topic86"></a><div class="CTopic TFunction LExcelVBA">
 <div class="CTitle">Read_File</div>
 <div class="CBody"><pre>Public Function Read_File(ByVal xFileName As Variant) As String()</pre><div class="CHeading">Description</div><p>Read the input file line by line.</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">xFileName As Variant</td><td class="CDLDefinition"><p>File path to an input file in csv or tab separated.</p></td></tr></table><div class="CHeading">Returns</div><p>A string array in which each entry is one row of data separated by a delimiter. For example, in a .csv file, the delimiter is usually &quot;,&quot;. If the file has a header and one line of data, the array will look like this.</p><ul><li><p>Read_File(0) = &quot;Column1,Column2&quot;</p></li><li><p>Read_File(1) = &quot;Data1,Data2&quot;</p></li></ul><div class="CHeading">Examples</div><pre>Dim SampleAnnotFile As String<br />Dim TestFolder As String<br /><br />Dim Lines() As String<br />Dim Delimiter As String<br /><br />TestFolder = ThisWorkbook.Path &amp; <span class="SHString">&quot;\Testdata\&quot;</span><br /><span class="SHString">SampleAnnotFile = TestFolder &amp; &quot;</span>Sample_Annotation_Example.csv<span class="SHString">&quot;</span><br /><br /><span class="SHString">Lines = Utilities.Read_File(SampleAnnotFile)</span><br /><span class="SHString">Delimiter = Utilities.Get_Delimiter(SampleAnnotFile)</span></pre></div>
</div>

<a name="Get_Delimiter"></a><a name="Topic94"></a><div class="CTopic TFunction LExcelVBA">
 <div class="CTitle">Get_Delimiter</div>
 <div class="CBody"><pre>Public Function Get_Delimiter(ByRef xFileName As Variant) As String</pre><div class="CHeading">Description</div><p>Get the delimiter of the input file. Currently, we can only identify &quot;,&quot; if a .csv file is provided and tab if a .txt file is provided.</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">xFileName As String</td><td class="CDLDefinition"><p>File path to the input file in csv or tab separated.</p></td></tr></table><div class="CHeading">Returns</div><p>A string &quot;,&quot; if a .csv file is provided or vbtab if a .txt file is provided.</p><div class="CHeading">Examples</div><pre>Dim SampleAnnotFile As String<br />Dim TestFolder As String<br /><br />Dim Lines() As String<br />Dim Delimiter As String<br /><br />TestFolder = ThisWorkbook.Path &amp; <span class="SHString">&quot;\Testdata\&quot;</span><br /><span class="SHString">SampleAnnotFile = TestFolder &amp; &quot;</span>Sample_Annotation_Example.csv<span class="SHString">&quot;</span><br /><br /><span class="SHString">Lines = Utilities.Read_File(SampleAnnotFile)</span><br /><span class="SHString">Delimiter = Utilities.Get_Delimiter(SampleAnnotFile)</span></pre></div>
</div>

<a name="Clear_DotD_In_Agilent_Data_File"></a><a name="Topic95"></a><div class="CTopic TFunction LExcelVBA last">
 <div class="CTitle">Clear_DotD_In_Agilent_Data_File</div>
 <div class="CBody"><pre>Public Function Clear_DotD_In_Agilent_Data_File(ByRef AgilentDataFile() As String) As String()</pre><div class="CHeading">Description</div><p>Remove the &quot;.d&quot; in the AgilentDataFile String Array.&nbsp; The Agilent files from Agilent MassHunter Quant has a &quot;Data File&quot; column which is unique in every row and is usually used as the Sample Name. The &quot;Data File&quot; column usually ends with &quot;.d&quot;. This function helps to remove this &quot;.d&quot;</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">AgilentDataFile() As String</td><td class="CDLDefinition"><p>A string array in which each entry is a data file name that ends with &quot;.d&quot;</p></td></tr></table><div class="CHeading">Returns</div><p>A string array in which each entry has &quot;.d&quot; remove</p><div class="CHeading">Examples</div><pre>Dim Sample_Name_Array(<span class="SHNumber">1</span>) As String<br /><br />Sample_Name_Array(<span class="SHNumber">0</span>) = <span class="SHString">&quot;Sample_Name_1.d&quot;</span><br />Sample_Name_Array(<span class="SHNumber">1</span>) = <span class="SHString">&quot;Sample_Name_2.d&quot;</span><br /><br />Sample_Name_Array = Utilities.Clear_DotD_In_Agilent_Data_File(Sample_Name_Array)</pre></div>
</div>

</body></html>