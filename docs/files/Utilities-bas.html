<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">

<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Utilities.bas</title><link rel="stylesheet" type="text/css" href="../styles/main.css" /><script type="text/javascript" src="../styles/main.js"></script><script type="text/javascript">NDLoader.LoadJS("Content", "../styles/");</script></head>

<!-- Generated by Natural Docs, version 2.1.1 -->

<!-- saved from url=(0016)http://localhost -->

<body onload="NDLoader.OnLoad('Content');" class="NDPage NDContentPage">

<a name="Functions"></a><a name="Topic67"></a><div class="CTopic TGroup LExcelVBA first">
 <div class="CTitle">Functions</div>
</div>

<a name="Concantenate_String_Arrays"></a><a name="Topic17"></a><div class="CTopic TFunction LExcelVBA">
 <div class="CTitle">Concantenate_String_Arrays</div>
 <div class="CBody"><pre>Public Function Concantenate_String_Arrays(ByRef TopArray() As String, _<br />                                           ByRef BottomArray() As String) As String()</pre><div class="CHeading">Description</div><p>Concantenate two string arrays into one string array</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">TopArray() As String</td><td class="CDLDefinition"><p>First string array to be concantenated</p></td></tr><tr><td class="CDLEntry">BottomArray() As String</td><td class="CDLDefinition"><p>Second string array to be concantenated</p></td></tr></table><div class="CHeading">Returns</div><p>A string array of that contains {Contents of TopArray, Contents of BottomArray}</p><div class="CHeading">Examples</div><pre>Dim TopArray(<span class="SHNumber">2</span>) As String<br />Dim BottomArray(<span class="SHNumber">2</span>) As String<br />Dim Concatenated_Array() As String<br /><br />TopArray(<span class="SHNumber">0</span>) = <span class="SHString">&quot;SM 36:0&quot;</span><br />TopArray(<span class="SHNumber">1</span>) = <span class="SHString">&quot;SM 36:1&quot;</span><br />TopArray(<span class="SHNumber">2</span>) = <span class="SHString">&quot;SM 36:2&quot;</span><br />BottomArray(<span class="SHNumber">0</span>) = <span class="SHString">&quot;SM 38:0&quot;</span><br />BottomArray(<span class="SHNumber">1</span>) = <span class="SHString">&quot;SM 38:1&quot;</span><br />BottomArray(<span class="SHNumber">2</span>) = <span class="SHString">&quot;SM 38:2&quot;</span><br /><br />Concatenated_Array = Utilities.Concantenate_String_Arrays(TopArray:=TopArray, _<br />                                                          BottomArray:=BottomArray)</pre></div>
</div>

<a name="Get_RowName_Position_From_2Darray"></a><a name="Topic228"></a><div class="CTopic TFunction LExcelVBA">
 <div class="CTitle">Get_RowName_Position_From_2Darray</div>
 <div class="CBody"><pre>Public Function Get_RowName_Position_From_2Darray(ByRef Lines() As String, _<br />                                                  ByVal RowName As String, _<br />                                                  ByVal RowNameNumber As Variant, _<br />                                                  ByVal Delimiter As String) As Variant</pre><div class="CHeading">Description</div><p>Get the row position of &quot;RowName&quot; in the column highlighted by &quot;RowNameNumber&quot; in a 2D string array Lines().</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">Lines() As String</td><td class="CDLDefinition"><p>A 2D string array. We let the number of elements (rows) of Lines be n. Each element of Lines is in the form &quot;EntryRow1 Column1,EntryRow1 Column2, ...,EntryRow1 Column p&quot; where p is the number of columns.</p></td></tr><tr><td class="CDLEntry">RowName As String</td><td class="CDLDefinition"><p>Name of the entry to look for in Lines() to get the starting row position</p></td></tr><tr><td class="CDLEntry">RowNameNumber As Variant</td><td class="CDLDefinition"><p>Column number to look at in Lines(), to look for RowName to get the starting row position. 0 is the first column. p-1 is the last column.</p></td></tr><tr><td class="CDLEntry">Delimiter As String</td><td class="CDLDefinition"><p>Delimiter used to separate each entries in one element of Lines(). For example, the delimiter for &quot;EntryRow1 Column1,EntryRow1 Column2,...,EntryRow1 Column p&quot; is &quot;,&quot;</p></td></tr></table><div class="CHeading">Returns</div><p>An integer indicating the row position of &quot;RowName&quot; .</p><div class="CHeading">Examples</div><pre>Dim TestFolder As String<br />Dim TidyDataColumnFile As String<br /><br /><span class="SHString">'Indicate path to the test data folder</span><br /><span class="SHString">TestFolder = ThisWorkbook.Path &amp; &quot;\Testdata\&quot;</span><br /><span class="SHString">TidyDataColumnFile = TestFolder &amp; &quot;TidyTransitionColumn.csv&quot;</span><br /><br /><span class="SHString">'</span>Read the csv files<br />Dim Lines() As String<br />Lines = Utilities.Read_File(TidyDataColumnFile)<br /><br />Dim RowNamePosition As Variant<br /><br /><span class="SHString">' Find which row is &quot;Sample_Name&quot; found in the &quot;RowName&quot; column.</span><br /><span class="SHString">' &quot;RowName&quot;</span> column is the first column hence RowNameNumber is <span class="SHKeyword">set</span> as <span class="SHNumber">0</span><br /><span class="SHString">' RowNamePosition should return 0 as &quot;Sample_Name&quot; is the first row</span><br /><span class="SHString">RowNamePosition = Utilities.Get_RowName_Position_From_2Darray(Lines:=Lines, _</span><br /><span class="SHString">                                                              RowName:=&quot;Sample_Name&quot;, _</span><br /><span class="SHString">                                                              RowNameNumber:=0, _</span><br /><span class="SHString">                                                              Delimiter:=&quot;,&quot;)</span><br /><br /><span class="SHString">'</span> Must be <span class="SHNumber">0</span><br />Debug.Print RowNamePosition<br /><br /><span class="SHString">' RowNamePosition should return 1 as &quot;Sample1&quot; is the second row</span><br /><span class="SHString">'</span> <span class="SHKeyword">in</span> the first column<br />RowNamePosition = Utilities.Get_RowName_Position_From_2Darray(Lines:=Lines, _<br />                                                              RowName:=<span class="SHString">&quot;Sample1&quot;</span>, _<br />                                                              RowNameNumber:=<span class="SHNumber">0</span>, _<br />                                                              Delimiter:=<span class="SHString">&quot;,&quot;</span>)<br /><span class="SHString">' Must be 1</span><br /><span class="SHString">Debug.Print RowNamePosition</span></pre></div>
</div>

<a name="Load_Rows_From_2Darray"></a><a name="Topic229"></a><div class="CTopic TFunction LExcelVBA">
 <div class="CTitle">Load_Rows_From_2Darray</div>
 <div class="CBody"><pre>Public Function Load_Rows_From_2Darray(ByRef InputStringArray() As String, _<br />                                       ByRef Lines() As String, _<br />                                       ByVal DataStartColumnNumber As Long, _<br />                                       ByVal Delimiter As String, _<br />                                       ByVal RemoveBlksAndReplicates As Boolean, _<br />                                       Optional ByVal RowName As String, _<br />                                       Optional ByVal RowNameNumber As Variant, _<br />                                       Optional ByVal DataStartRowNumber As Variant) As String()</pre><div class="CHeading">Description</div><p>Load row entries from a 2D string array given a starting column and row number. If starting row number cannot be identified, user can key in the starting &quot;RowName&quot; to look out for at column number &quot;RowNameNumber&quot; and the system will help identify the correct starting row number.</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">InputStringArray() As String</td><td class="CDLDefinition"><p>A string Array to load/append the row entries</p></td></tr><tr><td class="CDLEntry">Lines() As String</td><td class="CDLDefinition"><p>A 2D string array. We let the number of elements (rows) of Lines be n. Each element of Lines is in the form &quot;EntryRow1 Column1,EntryRow1 Column2, ...,EntryRow1 Column p&quot; where p is the number of columns.</p></td></tr><tr><td class="CDLEntry">DataStartColumnNumber As Long</td><td class="CDLDefinition"><p>An integer to indicate the starting column to read data and put it to InputStringArray</p></td></tr><tr><td class="CDLEntry">Delimiter As String</td><td class="CDLDefinition"><p>Delimiter used to separate each entries in one element of Lines(). For example, the delimiter for &quot;EntryRow1 Column1,EntryRow1 Column2,...,EntryRow1 Column p&quot; is &quot;,&quot;</p></td></tr><tr><td class="CDLEntry">RemoveBlksAndReplicates As Boolean</td><td class="CDLDefinition"><p>If set to True, the system will remove duplicates and blank values in InputStringArray</p></td></tr><tr><td class="CDLEntry">RowName As String</td><td class="CDLDefinition"><p>Name of the entry to look for in Lines() to get the starting row position</p></td></tr><tr><td class="CDLEntry">RowNameNumber As Variant</td><td class="CDLDefinition"><p>Column number to look at in Lines(), to look for RowName to get the starting row position. 0 is the first column. p-1 is the last column.</p></td></tr><tr><td class="CDLEntry">DataStartRowNumber As Variant</td><td class="CDLDefinition"><p>An integer to indicate the starting row to read data and put it to InputStringArray.</p></td></tr></table><div class="CHeading">Returns</div><p>A string array of row entries from a 2D string array.</p><div class="CHeading">Examples</div><pre>Dim TestFolder As String<br />Dim Transition_Array() As String<br />Dim TidyDataRowFile As String<br /><br /><span class="SHString">'Indicate path to the test data folder</span><br /><span class="SHString">TestFolder = ThisWorkbook.Path &amp; &quot;\Testdata\&quot;</span><br /><span class="SHString">TidyDataRowFile = TestFolder &amp; &quot;TidyTransitionRow.csv&quot;</span><br /><br /><span class="SHString">'</span>Read the csv files<br />Dim Lines() As String<br />Lines = Utilities.Read_File(TidyDataRowFile)<br /><br />Transition_Array = Utilities.Load_Columns_From_2Darray(InputStringArray:=Transition_Array, _<br />                                                       Lines:=Lines, _<br />                                                       DataStartColumnNumber:=<span class="SHNumber">0</span>, _<br />                                                       DataStartRowNumber:=<span class="SHNumber">1</span>, _<br />                                                       Delimiter:=<span class="SHString">&quot;,&quot;</span>, _<br />                                                       RemoveBlksAndReplicates:=True)<br /><br />Dim header_line_index As Long<br />For header_line_index = LBound(Transition_Array) To UBound(Transition_Array)<br />    Debug.Print Transition_Array(header_line_index)<br />Next header_line_index</pre></div>
</div>

<a name="Get_Header_Col_Position_From_2Darray"></a><a name="Topic230"></a><div class="CTopic TFunction LExcelVBA">
 <div class="CTitle">Get_Header_Col_Position_From_2Darray</div>
 <div class="CBody"><pre>Public Function Get_Header_Col_Position_From_2Darray(ByRef Lines() As String, _<br />                                                     ByVal HeaderName As String, _<br />                                                     ByVal HeaderRowNumber As Variant, _<br />                                                     ByVal Delimiter As String) As Variant</pre><div class="CHeading">Description</div><p>Get the column position of &quot;HeaderName&quot; in the row highlighted by &quot;HeaderRowNumber&quot; in a 2D string array Lines().</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">Lines() As String</td><td class="CDLDefinition"><p>A 2D string array. We let the number of elements (rows) of Lines be n. Each element of Lines is in the form &quot;EntryRow1 Column1,EntryRow1 Column2, ...,EntryRow1 Column p&quot; where p is the number of columns.</p></td></tr><tr><td class="CDLEntry">HeaderName As String</td><td class="CDLDefinition"><p>Name of the entry to look for in Lines() to get the starting column position</p></td></tr><tr><td class="CDLEntry">HeaderRowNumber As Variant</td><td class="CDLDefinition"><p>Row number to look at in Lines(), to look for HeaderName to get the starting column position. 0 is the first row. n-1 is the last row.</p></td></tr><tr><td class="CDLEntry">Delimiter As String</td><td class="CDLDefinition"><p>Delimiter used to separate each entries in one element of Lines(). For example, the delimiter for &quot;EntryRow1 Column1,EntryRow1 Column2,...,EntryRow1 Column p&quot; is &quot;,&quot;</p></td></tr></table><div class="CHeading">Returns</div><p>An integer indicating the column position of &quot;HeaderName&quot; .</p><div class="CHeading">Examples</div><pre>Dim TestFolder As String<br />Dim TidyDataColumnFile As String<br /><br /><span class="SHString">'Indicate path to the test data folder</span><br /><span class="SHString">TestFolder = ThisWorkbook.Path &amp; &quot;\Testdata\&quot;</span><br /><span class="SHString">TidyDataColumnFile = TestFolder &amp; &quot;TidyTransitionColumn.csv&quot;</span><br /><br /><span class="SHString">'</span>Read the csv files<br />Dim Lines() As String<br />Lines = Utilities.Read_File(TidyDataColumnFile)<br /><br /><span class="SHString">'Get column position of a given header name</span><br /><span class="SHString">Dim HeaderColNumber As Variant</span><br /><br /><span class="SHString">'</span> Find which column is <span class="SHString">&quot;Sample_Name&quot;</span> found <span class="SHKeyword">in</span> the <span class="SHString">&quot;HeaderName&quot;</span> row.<br /><span class="SHString">' &quot;HeaderName&quot; row is the first row hence HeaderRowNumber is set as 0</span><br /><span class="SHString">'</span> HeaderColNumber should <span class="SHKeyword">return</span> <span class="SHNumber">0</span> as <span class="SHString">&quot;Sample_Name&quot;</span> is the first column<br />HeaderColNumber = Utilities.Get_Header_Col_Position_From_2Darray(Lines:=Lines, _<br />                                                                 HeaderName:=<span class="SHString">&quot;Sample_Name&quot;</span>, _<br />                                                                 HeaderRowNumber:=<span class="SHNumber">0</span>, _<br />                                                                 Delimiter:=<span class="SHString">&quot;,&quot;</span>)<br /><br /><span class="SHString">' Must be 0</span><br /><span class="SHString">Debug.Print HeaderColNumber</span><br /><br /><span class="SHString">'</span> HeaderColNumber should <span class="SHKeyword">return</span> <span class="SHNumber">1</span> as <span class="SHString">&quot;LPC 14:0&quot;</span> is at the second column<br />HeaderColNumber = Utilities.Get_Header_Col_Position_From_2Darray(Lines:=Lines, _<br />                                                                 HeaderName:=<span class="SHString">&quot;LPC 14:0&quot;</span>, _<br />                                                                 HeaderRowNumber:=<span class="SHNumber">0</span>, _<br />                                                                 Delimiter:=<span class="SHString">&quot;,&quot;</span>)<br /><br /><span class="SHString">' Must be 1</span><br /><span class="SHString">Debug.Print HeaderColNumber</span></pre></div>
</div>

<a name="Load_Columns_From_2Darray"></a><a name="Topic231"></a><div class="CTopic TFunction LExcelVBA">
 <div class="CTitle">Load_Columns_From_2Darray</div>
 <div class="CBody"><pre>Public Function Load_Columns_From_2Darray(ByRef InputStringArray() As String, _<br />                                          ByRef Lines() As String, _<br />                                          ByVal DataStartRowNumber As Long, _<br />                                          ByVal Delimiter As String, _<br />                                          ByVal RemoveBlksAndReplicates As Boolean, _<br />                                          Optional ByVal HeaderName As String, _<br />                                          Optional ByVal HeaderRowNumber As Variant, _<br />                                          Optional ByVal DataStartColumnNumber As Variant) As String()</pre><div class="CHeading">Description</div><p>Load column entries from a 2D string array given a starting row and column number. If starting column number cannot be identified, user can key in the starting &quot;HeaderName&quot; to look out for at row number &quot;HeaderRowNumber&quot; and the system will help identify the correct starting column number.</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">InputStringArray() As String</td><td class="CDLDefinition"><p>A string Array to load/append the column entries</p></td></tr><tr><td class="CDLEntry">Lines() As String</td><td class="CDLDefinition"><p>A 2D string array. We let the number of elements (rows) of Lines be n. Each element of Lines is in the form &quot;EntryRow1 Column1,EntryRow1 Column2, ...,EntryRow1 Column p&quot; where p is the number of columns.</p></td></tr><tr><td class="CDLEntry">DataStartRowNumber As Long</td><td class="CDLDefinition"><p>An integer to indicate the starting row to read data and put it to InputStringArray</p></td></tr><tr><td class="CDLEntry">Delimiter As String</td><td class="CDLDefinition"><p>Delimiter used to separate each entries in one element of Lines(). For example, the delimiter for &quot;EntryRow1 Column1,EntryRow1 Column2,...,EntryRow1 Column p&quot; is &quot;,&quot;</p></td></tr><tr><td class="CDLEntry">RemoveBlksAndReplicates As Boolean</td><td class="CDLDefinition"><p>If set to True, the system will remove duplicates and blank values in InputStringArray</p></td></tr><tr><td class="CDLEntry">HeaderName As String</td><td class="CDLDefinition"><p>Name of the entry to look for in Lines() to get the starting column position</p></td></tr><tr><td class="CDLEntry">HeaderRowNumber As Variant</td><td class="CDLDefinition"><p>Row number to look at in Lines(), to look for HeaderName to get the starting column position. 0 is the first row. n-1 is the last row.</p></td></tr><tr><td class="CDLEntry">DataStartColumnNumber As Variant</td><td class="CDLDefinition"><p>An integer to indicate the starting column to read data and put it to InputStringArray.</p></td></tr></table><div class="CHeading">Returns</div><p>A string array of column entries from a 2D string array.</p><div class="CHeading">Examples</div><pre>Dim TestFolder As String<br />Dim Transition_Array() As String<br />Dim TidyDataRowFile As String<br /><br /><br /><span class="SHString">'Indicate path to the test data folder</span><br /><span class="SHString">TestFolder = ThisWorkbook.Path &amp; &quot;\Testdata\&quot;</span><br /><span class="SHString">TidyDataRowFile = TestFolder &amp; &quot;TidyTransitionRow.csv&quot;</span><br /><br /><span class="SHString">'</span>Read the csv files<br />Dim Lines() As String<br />Lines = Utilities.Read_File(TidyDataRowFile)<br /><br />Transition_Array = Utilities.Load_Columns_From_2Darray(InputStringArray:=Transition_Array, _<br />                                                       Lines:=Lines, _<br />                                                       DataStartColumnNumber:=<span class="SHNumber">0</span>, _<br />                                                       DataStartRowNumber:=<span class="SHNumber">1</span>, _<br />                                                       Delimiter:=<span class="SHString">&quot;,&quot;</span>, _<br />                                                       RemoveBlksAndReplicates:=True)<br /><br />Dim header_line_index As Long<br />For header_line_index = LBound(Transition_Array) To UBound(Transition_Array)<br />    Debug.Print Transition_Array(header_line_index)<br />Next header_line_index</pre></div>
</div>

<a name="Read_File"></a><a name="Topic86"></a><div class="CTopic TFunction LExcelVBA">
 <div class="CTitle">Read_File</div>
 <div class="CBody"><pre>Public Function Read_File(ByVal xFileName As Variant) As String()</pre><div class="CHeading">Description</div><p>Read the input file line by line.</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">xFileName As Variant</td><td class="CDLDefinition"><p>File path to an input file in csv or tab separated.</p></td></tr></table><div class="CHeading">Returns</div><p>A string array in which each entry is one row of data separated by a delimiter. For example, in a .csv file, the delimiter is usually &quot;,&quot;. If the file has a header and one line of data, the array will look like this.</p><ul><li><p>Read_File(0) = &quot;Column1,Column2&quot;</p></li><li><p>Read_File(1) = &quot;Data1,Data2&quot;</p></li></ul><div class="CHeading">Examples</div><pre>Dim SampleAnnotFile As String<br />Dim TestFolder As String<br /><br />Dim Lines() As String<br />Dim Delimiter As String<br /><br />TestFolder = ThisWorkbook.Path &amp; <span class="SHString">&quot;\Testdata\&quot;</span><br /><span class="SHString">SampleAnnotFile = TestFolder &amp; &quot;</span>Sample_Annotation_Example.csv<span class="SHString">&quot;</span><br /><br /><span class="SHString">Lines = Utilities.Read_File(SampleAnnotFile)</span><br /><span class="SHString">Delimiter = Utilities.Get_Delimiter(SampleAnnotFile)</span></pre></div>
</div>

<a name="Get_Delimiter"></a><a name="Topic94"></a><div class="CTopic TFunction LExcelVBA">
 <div class="CTitle">Get_Delimiter</div>
 <div class="CBody"><pre>Public Function Get_Delimiter(ByRef xFileName As Variant) As String</pre><div class="CHeading">Description</div><p>Get the delimiter of the input file. Currently, we can only identify &quot;,&quot; if a .csv file is provided and tab if a .txt file is provided.</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">xFileName As String</td><td class="CDLDefinition"><p>File path to the input file in csv or tab separated.</p></td></tr></table><div class="CHeading">Returns</div><p>A string &quot;,&quot; if a .csv file is provided or vbtab if a .txt file is provided.</p><div class="CHeading">Examples</div><pre>Dim SampleAnnotFile As String<br />Dim TestFolder As String<br /><br />Dim Lines() As String<br />Dim Delimiter As String<br /><br />TestFolder = ThisWorkbook.Path &amp; <span class="SHString">&quot;\Testdata\&quot;</span><br /><span class="SHString">SampleAnnotFile = TestFolder &amp; &quot;</span>Sample_Annotation_Example.csv<span class="SHString">&quot;</span><br /><br /><span class="SHString">Lines = Utilities.Read_File(SampleAnnotFile)</span><br /><span class="SHString">Delimiter = Utilities.Get_Delimiter(SampleAnnotFile)</span></pre></div>
</div>

<a name="Get_File_Base_Name"></a><a name="Topic232"></a><div class="CTopic TFunction LExcelVBA">
 <div class="CTitle">Get_File_Base_Name</div>
 <div class="CBody"><pre>Public Function Get_File_Base_Name(ByVal xFileName As Variant) As String</pre><div class="CHeading">Description</div><p>Get the base name of a given file path.</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">xFileName As String</td><td class="CDLDefinition"><p>File path to the input file in csv or tab separated.</p></td></tr></table><div class="CHeading">Returns</div><p>A string indicating the base name of a given file path</p><div class="CHeading">Examples</div><pre>Dim SampleAnnotFile As String<br />Dim TestFolder As String<br />Dim FileName As String<br /><br />TestFolder = ThisWorkbook.Path &amp; <span class="SHString">&quot;\Testdata\&quot;</span><br /><span class="SHString">SampleAnnotFile = TestFolder &amp; &quot;</span>Sample_Annotation_Example.csv<span class="SHString">&quot;</span><br /><br /><span class="SHString">FileName = Utilities.Get_File_Base_Name(SampleAnnotFile)</span><br /><br /><span class="SHString">Debug.Print FileName</span></pre></div>
</div>

<a name="Get_Raw_Data_File_Type"></a><a name="Topic233"></a><div class="CTopic TFunction LExcelVBA">
 <div class="CTitle">Get_Raw_Data_File_Type</div>
 <div class="CBody"><pre>Public Function Get_Raw_Data_File_Type(ByRef Lines() As String, _<br />                                       ByVal Delimiter As String, _<br />                                       ByVal xFileName As String) As String</pre><div class="CHeading">Description</div><p>Get the type of an input raw data file. It can be in &quot;AgilentWideForm&quot;, &quot;AgilentCompoundForm&quot; or &quot;Sciex&quot;</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">Lines() As String</td><td class="CDLDefinition"><p>A 2D string array. We let the number of elements (rows) of Lines be n. Each element of Lines is in the form &quot;EntryRow1 Column1,EntryRow1 Column2, ...,EntryRow1 Column p&quot; where p is the number of columns.</p></td></tr><tr><td class="CDLEntry">Delimiter As String</td><td class="CDLDefinition"><p>Delimiter used to separate each entries in one element of Lines(). For example, the delimiter for &quot;EntryRow1 Column1,EntryRow1 Column2,...,EntryRow1 Column p&quot; is &quot;,&quot;</p></td></tr><tr><td class="CDLEntry">xFileName As String</td><td class="CDLDefinition"><p>File path to the input file in csv or tab separated.</p></td></tr></table><div class="CHeading">Returns</div><p>A string indicating the base name of a given file path</p><div class="CHeading">Examples</div><pre>Dim Lines() As String<br />Dim Delimiter As String<br />Dim FileName As String<br />Dim RawDataFileType As String<br />Dim TestFolder As String<br />Dim RawDataFile As String<br /><br /><span class="SHString">'Indicate path to the test data folder</span><br /><span class="SHString">TestFolder = ThisWorkbook.Path &amp; &quot;\Testdata\&quot;</span><br /><span class="SHString">RawDataFile = TestFolder &amp; &quot;AgilentRawDataTest1.csv&quot;</span><br /><br /><span class="SHString">Lines = Utilities.Read_File(RawDataFile)</span><br /><span class="SHString">Delimiter = Utilities.Get_Delimiter(RawDataFile)</span><br /><span class="SHString">FileName = Utilities.Get_File_Base_Name(RawDataFile)</span><br /><span class="SHString">RawDataFileType = Utilities.Get_Raw_Data_File_Type(Lines, Delimiter, FileName)</span><br /><br /><span class="SHString">Debug.Print RawDataFileType</span><br /><br /><span class="SHString">RawDataFile = TestFolder &amp; &quot;CompoundTableForm.csv&quot;</span><br /><br /><span class="SHString">Lines = Utilities.Read_File(RawDataFile)</span><br /><span class="SHString">Delimiter = Utilities.Get_Delimiter(RawDataFile)</span><br /><span class="SHString">FileName = Utilities.Get_File_Base_Name(RawDataFile)</span><br /><span class="SHString">RawDataFileType = Utilities.Get_Raw_Data_File_Type(Lines, Delimiter, FileName)</span><br /><br /><span class="SHString">Debug.Print RawDataFileType</span><br /><br /><span class="SHString">RawDataFile = TestFolder &amp; &quot;SciExTestData.txt&quot;</span><br /><br /><span class="SHString">Lines = Utilities.Read_File(RawDataFile)</span><br /><span class="SHString">Delimiter = Utilities.Get_Delimiter(RawDataFile)</span><br /><span class="SHString">FileName = Utilities.Get_File_Base_Name(RawDataFile)</span><br /><span class="SHString">RawDataFileType = Utilities.Get_Raw_Data_File_Type(Lines, Delimiter, FileName)</span><br /><br /><span class="SHString">Debug.Print RawDataFileType</span></pre></div>
</div>

<a name="Remove_Filter_Settings"></a><a name="Topic234"></a><div class="CTopic TFunction LExcelVBA">
 <div class="CTitle">Remove_Filter_Settings</div>
 <div class="CBody"><pre>Public Sub Remove_Filter_Settings()</pre><div class="CHeading">Description</div><p>Remove any filter settings in the active sheet.</p></div>
</div>

<a name="Get_Header_Col_Position"></a><a name="Topic235"></a><div class="CTopic TFunction LExcelVBA">
 <div class="CTitle">Get_Header_Col_Position</div>
 <div class="CBody"><pre>Public Function Get_Header_Col_Position(ByVal HeaderName As String, _<br />                                        ByVal HeaderRowNumber As Long, _<br />                                        Optional ByVal WorksheetName As String = vbNullString) As Long</pre><div class="CHeading">Description</div><p>Get the column position for a given header name and a header row number to look at.</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">HeaderName As String</td><td class="CDLDefinition"><p>Name of the header/column name to look for</p></td></tr><tr><td class="CDLEntry">HeaderRowNumber As Long</td><td class="CDLDefinition"><p>Row position in which the header/column name could possibly be.</p></td></tr><tr><td class="CDLEntry">WorksheetName As String</td><td class="CDLDefinition"><p>Name of the worksheet to search for the header/column name. If it is blank, the active sheet will be used.</p></td></tr></table><div class="CHeading">Returns</div><p>An integer indicating the column position for a given header name</p><div class="CHeading">Examples</div><pre><span class="SHString">'Should be 1 as it is the first column</span><br /><span class="SHString">Debug.Print Utilities.Get_Header_Col_Position(&quot;Transition_Name&quot;, 1, &quot;Transition_Name_Annot&quot;)</span><br /><br /><span class="SHString">'</span>Should be <span class="SHNumber">2</span> as it is the second column<br />Debug.Print Utilities.Get_Header_Col_Position(<span class="SHString">&quot;Transition_Name_ISTD&quot;</span>, <span class="SHNumber">1</span>, <span class="SHString">&quot;Transition_Name_Annot&quot;</span>)</pre></div>
</div>

<a name="Last_Used_Row_Number"></a><a name="Topic236"></a><div class="CTopic TFunction LExcelVBA">
 <div class="CTitle">Last_Used_Row_Number</div>
 <div class="CBody"><pre>Public Function Last_Used_Row_Number() As Long</pre><div class="CHeading">Description</div><p>Get the last used row number of the active sheet</p><div class="CHeading">Returns</div><p>An integer indicating the row position where the last entry is</p><div class="CHeading">Examples</div><pre><span class="SHString">' Get the Lists worksheet from the active workbook</span><br /><span class="SHString">'</span> The Lists is a code name<br /><span class="SHString">' Refer to https://riptutorial.com/excel-vba/example/11272/worksheet--name---index-or--codename</span><br /><span class="SHString">Dim Lists_Worksheet As Worksheet</span><br /><br /><span class="SHString">If Utilities.Check_Sheet_Code_Name_Exists(ActiveWorkbook, &quot;Lists&quot;) = False Then</span><br /><span class="SHString">    MsgBox (&quot;Sheet Lists is missing&quot;)</span><br /><span class="SHString">    Application.EnableEvents = True</span><br /><span class="SHString">    Exit Sub</span><br /><span class="SHString">End If</span><br /><br /><span class="SHString">Set Lists_Worksheet = Utilities.Get_Sheet_By_Code_Name(ActiveWorkbook, &quot;Lists&quot;)</span><br /><br /><span class="SHString">Lists_Worksheet.Activate</span><br /><br /><span class="SHString">Debug.Print Utilities.Last_Used_Row_Number</span></pre></div>
</div>

<a name="Convert_To_Letter"></a><a name="Topic237"></a><div class="CTopic TFunction LExcelVBA">
 <div class="CTitle">Convert_To_Letter</div>
 <div class="CBody"><pre>Public Function Convert_To_Letter(ByVal Column_Index As Long) As String</pre><div class="CHeading">Description</div><p>Convert column position in integers to alphabets</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">Column_Index As Long</td><td class="CDLDefinition"><p>An integer indicating the column position</p></td></tr></table><div class="CHeading">Returns</div><p>An string representing a column position in alphabets</p><div class="CHeading">Examples</div><pre><span class="SHString">' Should be A</span><br /><span class="SHString">Debug.Print Utilities.Convert_To_Letter(1)</span><br /><span class="SHString">'</span> Should be Z<br />Debug.Print Utilities.Convert_To_Letter(<span class="SHNumber">26</span>)<br /><span class="SHString">' Should be AA</span><br /><span class="SHString">Debug.Print Utilities.Convert_To_Letter(27)</span><br /><span class="SHString">'</span> Should be AZ<br />Debug.Print Utilities.Convert_To_Letter(<span class="SHNumber">52</span>)<br /><span class="SHString">' Should be BA</span><br /><span class="SHString">Debug.Print Utilities.Convert_To_Letter(53)</span><br /><span class="SHString">'</span> Should be SZ<br />Debug.Print Utilities.Convert_To_Letter(<span class="SHNumber">520</span>)</pre></div>
</div>

<a name="Get_String_Array_Len"></a><a name="Topic238"></a><div class="CTopic TFunction LExcelVBA">
 <div class="CTitle">Get_String_Array_Len</div>
 <div class="CBody"><pre>Public Function Get_String_Array_Len(ByRef Some_Array As Variant) As Long</pre><div class="CHeading">Description</div><p>Get the number of elements in an input string array</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">Some_Array As Variant</td><td class="CDLDefinition"><p>An input string array</p></td></tr></table><div class="CHeading">Returns</div><p>An integer indicating how many elements are in the input string array</p><div class="CHeading">Examples</div><pre>Dim TestArray As Variant<br />Dim EmptyArray As Variant<br /><br />TestArray = Array(<span class="SHString">&quot;11_PQC-2.d&quot;</span>, <span class="SHString">&quot;20032017_TAG_SNEHAMTHD__Dogs_PL_PQC_2.d&quot;</span>, _<br />                  <span class="SHString">&quot;PQC_PC-PE-SM_01.d&quot;</span>, <span class="SHString">&quot;PQC1_LPC-LPE-PG-PI-PS_01.d&quot;</span>, <span class="SHString">&quot;PQC1_02.d&quot;</span>, _<br />                  <span class="SHString">&quot;11_BQC-2.d&quot;</span>, <span class="SHString">&quot;20032017_TAG_SNEHAMTHD__Dogs_PL_BQC_2.d&quot;</span>, <span class="SHString">&quot;018_BQC_PQC01&quot;</span>)<br />EmptyArray = Array()<br /><br /><span class="SHString">' Should be 8</span><br /><span class="SHString">Debug.Print Utilities.Get_String_Array_Len(TestArray)</span><br /><br /><span class="SHString">'</span> Should be <span class="SHNumber">0</span><br />Debug.Print Utilities.Get_String_Array_Len(EmptyArray)</pre></div>
</div>

<a name="Where_In_Array"></a><a name="Topic239"></a><div class="CTopic TFunction LExcelVBA">
 <div class="CTitle">Where_In_Array</div>
 <div class="CBody"><pre>Public Function Where_In_Array(ByVal valToBeFound As Variant, _<br />                               ByVal arr As Variant) As String()</pre><div class="CHeading">Description</div><p>Get the position in the input string array an input element is located</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">valToBeFound As Variant</td><td class="CDLDefinition"><p>Input string to be searched in the input array.</p></td></tr><tr><td class="CDLEntry">arr As Variant</td><td class="CDLDefinition"><p>Input array used to search for the input string</p></td></tr></table><div class="CHeading">Returns</div><p>A string array indicating the position the input string is located in the input array. If there is no match, the string array will be of length zero.</p><div class="CHeading">Examples</div><pre>Dim TestArray As Variant<br />Dim Positions() As String<br /><br /><span class="SHString">'Ensure that it works and gives the right position</span><br /><span class="SHString">TestArray = Array(&quot;Here&quot;, &quot;11_PQC-2.d&quot;, &quot;Here&quot;, &quot;No&quot;, &quot;Here&quot;, &quot;Here&quot;)</span><br /><br /><span class="SHString">'</span> A <span class="SHKeyword">string</span> array of {<span class="SHString">&quot;0&quot;</span>, <span class="SHString">&quot;2&quot;</span>, <span class="SHString">&quot;4&quot;</span>, <span class="SHString">&quot;5&quot;</span>}<br />Positions = Utilities.Where_In_Array(<span class="SHString">&quot;Here&quot;</span>, TestArray)</pre></div>
</div>

<a name="Is_In_Array"></a><a name="Topic240"></a><div class="CTopic TFunction LExcelVBA">
 <div class="CTitle">Is_In_Array</div>
 <div class="CBody"><pre>Public Function Is_In_Array(ByVal valToBeFound As Variant, _<br />                            ByVal arr As Variant) As Boolean</pre><div class="CHeading">Description</div><p>Check if an input element is located in the input string array</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">valToBeFound As Variant</td><td class="CDLDefinition"><p>Input string to be searched in the input array.</p></td></tr><tr><td class="CDLEntry">arr As Variant</td><td class="CDLDefinition"><p>Input array used to search for the input string</p></td></tr></table><div class="CHeading">Returns</div><p>True if an input element is located in the input string array.&nbsp; False otherwise.</p><div class="CHeading">Examples</div><pre>Dim TestArray As Variant<br />TestArray = Array(<span class="SHString">&quot;Here&quot;</span>, <span class="SHString">&quot;11_PQC-2.d&quot;</span>, <span class="SHString">&quot;Here&quot;</span>, <span class="SHString">&quot;No&quot;</span>, <span class="SHString">&quot;Here&quot;</span>, <span class="SHString">&quot;Here&quot;</span>)<br /><br /><span class="SHString">' Should be True</span><br /><span class="SHString">Debug.Print Utilities.Is_In_Array(&quot;Here&quot;, TestArray)</span><br /><span class="SHString">'</span> Should be True<br />Debug.Print Utilities.Is_In_Array(<span class="SHString">&quot;11_PQC-2.d&quot;</span>, TestArray)<br /><span class="SHString">' Should be False</span><br /><span class="SHString">Debug.Print Utilities.Is_In_Array(&quot;NotHere&quot;, TestArray)</span></pre></div>
</div>

<a name="Quick_Sort"></a><a name="Topic241"></a><div class="CTopic TFunction LExcelVBA">
 <div class="CTitle">Quick_Sort</div>
 <div class="CBody"><pre>Public Sub Quick_Sort(ByRef ThisArray As Variant)</pre><div class="CHeading">Description</div><p>Sort an the input string array in alphabetical order.</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">ThisArray As Variant</td><td class="CDLDefinition"><p>Input string array to be sorted in alphabetical order.</p></td></tr></table><div class="CHeading">Returns</div><p>A string array sorted in alphabetical order.</p><div class="CHeading">Examples</div><pre>Dim TestArray As Variant<br />TestArray = Array(<span class="SHString">&quot;SM C36:2&quot;</span>, <span class="SHString">&quot;lipid&quot;</span>, <span class="SHString">&quot;Cer d18:1/C16:0&quot;</span>)<br /><span class="SHString">' Should be {&quot;Cer d18:1/C16:0&quot;, &quot;SM C36:2&quot;, &quot;lipid&quot;}</span><br /><span class="SHString">Utilities.Quick_Sort ThisArray:=TestArray</span></pre></div>
</div>

<a name="Overwrite_Several_Headers"></a><a name="Topic242"></a><div class="CTopic TFunction LExcelVBA">
 <div class="CTitle">Overwrite_Several_Headers</div>
 <div class="CBody"><pre>Public Sub Overwrite_Several_Headers(ByRef HeaderNameArray() As String, _<br />                                     ByVal HeaderRowNumber As Long, _<br />                                     ByVal DataStartRowNumber As Long)</pre><div class="CHeading">Description</div><p>Function used to open this overwrite confirmation box</p><div class="CImage"><a href="../images/Overwrite_Box_Several_Headers_Example.png" target="_blank" class="ZoomLink"><img src="../images/Overwrite_Box_Several_Headers_Example.png" loading="lazy" class="KnownDimensions" width="439" height="171" style="max-width: 439px" alt="Overwrite_Box_Several_Headers_Example" /></a></div><p>If the overwrite button is pressed, data in the columns indicated in HeaderNameArray will be replaced with the updated data.</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">HeaderNameArray() As String</td><td class="CDLDefinition"><p>Input string array of headers or column names.</p></td></tr><tr><td class="CDLEntry">HeaderRowNumber As Long</td><td class="CDLDefinition"><p>An integer indicating the row where the headers or column names are in the sheet.</p></td></tr><tr><td class="CDLEntry">DataStartRowNumber As Long</td><td class="CDLDefinition"><p>An integer indicating the starting row where the data are.</p></td></tr></table></div>
</div>

<a name="Overwrite_Header"></a><a name="Topic243"></a><div class="CTopic TFunction LExcelVBA">
 <div class="CTitle">Overwrite_Header</div>
 <div class="CBody"><pre>Public Sub Overwrite_Header(ByVal HeaderName As String, _<br />                            ByVal HeaderRowNumber As Long, _<br />                            ByVal DataStartRowNumber As Long, _<br />                            Optional ByVal WorksheetName As String = vbNullString, _<br />                            Optional ByVal ClearContent As Boolean = True, _<br />                            Optional ByVal Testing As Boolean = False)</pre><div class="CHeading">Description</div><p>Function used to open this overwrite confirmation box</p><div class="CImage"><a href="../images/Overwrite_Box_One_Header_Example.png" target="_blank" class="ZoomLink"><img src="../images/Overwrite_Box_One_Header_Example.png" loading="lazy" class="KnownDimensions" width="405" height="171" style="max-width: 405px" alt="Overwrite_Box_One_Header_Example" /></a></div><p>If the overwrite button is pressed, data in the columns indicated in HeaderName will be replaced with the updated data.</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">HeaderName As String</td><td class="CDLDefinition"><p>Input string indicating the header or column name whose data to overwrite.</p></td></tr><tr><td class="CDLEntry">HeaderRowNumber As Long</td><td class="CDLDefinition"><p>An integer indicating the row where the headers or column names are in the sheet.</p></td></tr><tr><td class="CDLEntry">DataStartRowNumber As Long</td><td class="CDLDefinition"><p>An integer indicating the starting row where the data are.</p></td></tr><tr><td class="CDLEntry">WorksheetName As String</td><td class="CDLDefinition"><p>Name of the worksheet to search for the header/column name. If it is blank, the active sheet will be used.</p></td></tr><tr><td class="CDLEntry">ClearContent As Boolean</td><td class="CDLDefinition"><p>If True, contents will be cleared before updating/adding new data.</p></td></tr><tr><td class="CDLEntry">Testing As Boolean</td><td class="CDLDefinition"><p>When set to False, after the function is used, it will exit the program as this function is meant to be run alone or as a last/final step.&nbsp; When set to True, after the function is used, it will exit the function and other functions can be called</p></td></tr></table></div>
</div>

<a name="Load_To_Excel"></a><a name="Topic244"></a><div class="CTopic TFunction LExcelVBA">
 <div class="CTitle">Load_To_Excel</div>
 <div class="CBody"><pre>Public Sub Load_To_Excel(ByRef Data_Array() As String, _<br />                         ByVal HeaderName As String, _<br />                         ByVal HeaderRowNumber As Long, _<br />                         ByVal DataStartRowNumber As Long, _<br />                         ByVal MessageBoxRequired As Boolean, _<br />                         Optional ByVal WorksheetName As String = vbNullString, _<br />                         Optional ByVal NumberFormat As String = <span class="SHString">&quot;General&quot;</span>)</pre><div class="CHeading">Description</div><p>Function used to load a string array to an active excel sheet given the header name, row position where the header name is located and the starting row of the data.</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">Data_Array() As String</td><td class="CDLDefinition"><p>Input string array to be loaded to excel</p></td></tr><tr><td class="CDLEntry">HeaderName As String</td><td class="CDLDefinition"><p>Name of the header/column to tell the system which column to output the data.</p></td></tr><tr><td class="CDLEntry">HeaderRowNumber As Long</td><td class="CDLDefinition"><p>Input integer indicating the row number where the header/column name is located.</p></td></tr><tr><td class="CDLEntry">DataStartRowNumber As Long</td><td class="CDLDefinition"><p>Input integer indicating which row to start outputing the data.</p></td></tr><tr><td class="CDLEntry">MessageBoxRequired As Boolean</td><td class="CDLDefinition"><p>If set to True, a message box will appear after outputing the data saying how many entries have been loaded.</p></td></tr><tr><td class="CDLEntry">WorksheetName As String</td><td class="CDLDefinition"><p>Name of the worksheet to search for the header/column name. If it is blank, the active sheet will be used.</p></td></tr><tr><td class="CDLEntry">NumberFormat As String</td><td class="CDLDefinition"><p>Indicate how number loaded to excel will be expressed as. By default, it is general.&nbsp; Other options can be found in this <a href="https://support.microsoft.com/en-us/office/available-number-formats-in-excel-0afe8f52-97db-41f1-b972-4b46e9f1e8d2" target="_top">link</a>.</p></td></tr></table><div class="CHeading">Examples</div><pre><span class="SHString">' Get the Transition_Name_Annot worksheet from the active workbook</span><br /><span class="SHString">'</span> The TransitionNameAnnotSheet is a code name<br /><span class="SHString">' Refer to https://riptutorial.com/excel-vba/example/11272/worksheet--name---index-or--codename</span><br /><span class="SHString">Dim Transition_Name_Annot_Worksheet As Worksheet</span><br /><br /><span class="SHString">If Utilities.Check_Sheet_Code_Name_Exists(ActiveWorkbook, &quot;TransitionNameAnnotSheet&quot;) = False Then</span><br /><span class="SHString">    MsgBox (&quot;Sheet Transition_Name_Annot is missing&quot;)</span><br /><span class="SHString">    Application.EnableEvents = True</span><br /><span class="SHString">    Exit Sub</span><br /><span class="SHString">End If</span><br /><br /><span class="SHString">Set Transition_Name_Annot_Worksheet = Utilities.Get_Sheet_By_Code_Name(ActiveWorkbook, &quot;TransitionNameAnnotSheet&quot;)</span><br /><br /><span class="SHString">Transition_Name_Annot_Worksheet.Activate</span><br /><br /><span class="SHString">Dim Transition_Array(3) As String</span><br /><span class="SHString">Transition_Array(0) = &quot;SM 44:0&quot;</span><br /><span class="SHString">Transition_Array(1) = &quot;SM 44:1&quot;</span><br /><span class="SHString">Transition_Array(2) = &quot;SM 46:2&quot;</span><br /><span class="SHString">Transition_Array(3) = &quot;SM 46:3&quot;</span><br /><br /><span class="SHString">Utilities.Load_To_Excel Data_Array:=Transition_Array, _</span><br /><span class="SHString">                        HeaderName:=&quot;Transition_Name&quot;, _</span><br /><span class="SHString">                        HeaderRowNumber:=1, _</span><br /><span class="SHString">                        DataStartRowNumber:=2, _</span><br /><span class="SHString">                        MessageBoxRequired:=False</span></pre></div>
</div>

<a name="Clear_Columns"></a><a name="Topic245"></a><div class="CTopic TFunction LExcelVBA">
 <div class="CTitle">Clear_Columns</div>
 <div class="CBody"><pre>Public Sub Clear_Columns(ByVal HeaderToClear As String, _<br />                         ByVal HeaderRowNumber As Long, _<br />                         ByVal DataStartRowNumber As Long, _<br />                         Optional ByVal ClearFormat As Boolean = False)</pre><div class="CHeading">Description</div><p>Function used to clear a column in an active excel sheet given the header name to clear, row position where the header name is located and the starting row of the data.</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">HeaderName As String</td><td class="CDLDefinition"><p>Name of the header/column to tell the system which column to output the data.</p></td></tr><tr><td class="CDLEntry">HeaderRowNumber As Long</td><td class="CDLDefinition"><p>Input integer indicating the row number where the header/column name is located.</p></td></tr><tr><td class="CDLEntry">DataStartRowNumber As Long</td><td class="CDLDefinition"><p>Input integer indicating which row to start outputing the data.</p></td></tr></table><div class="CHeading">Examples</div><pre><span class="SHString">' Get the Transition_Name_Annot worksheet from the active workbook</span><br /><span class="SHString">'</span> The TransitionNameAnnotSheet is a code name<br /><span class="SHString">' Refer to https://riptutorial.com/excel-vba/example/11272/worksheet--name---index-or--codename</span><br /><span class="SHString">Dim Transition_Name_Annot_Worksheet As Worksheet</span><br /><br /><span class="SHString">If Utilities.Check_Sheet_Code_Name_Exists(ActiveWorkbook, &quot;TransitionNameAnnotSheet&quot;) = False Then</span><br /><span class="SHString">    MsgBox (&quot;Sheet Transition_Name_Annot is missing&quot;)</span><br /><span class="SHString">    Application.EnableEvents = True</span><br /><span class="SHString">    Exit Sub</span><br /><span class="SHString">End If</span><br /><br /><span class="SHString">Set Transition_Name_Annot_Worksheet = Utilities.Get_Sheet_By_Code_Name(ActiveWorkbook, &quot;TransitionNameAnnotSheet&quot;)</span><br /><br /><span class="SHString">Transition_Name_Annot_Worksheet.Activate</span><br /><br /><span class="SHString">Dim Transition_Array(3) As String</span><br /><span class="SHString">Transition_Array(0) = &quot;SM 44:0&quot;</span><br /><span class="SHString">Transition_Array(1) = &quot;SM 44:1&quot;</span><br /><span class="SHString">Transition_Array(2) = &quot;SM 46:2&quot;</span><br /><span class="SHString">Transition_Array(3) = &quot;SM 46:3&quot;</span><br /><br /><span class="SHString">Utilities.Load_To_Excel Data_Array:=Transition_Array, _</span><br /><span class="SHString">                        HeaderName:=&quot;Transition_Name&quot;, _</span><br /><span class="SHString">                        HeaderRowNumber:=1, _</span><br /><span class="SHString">                        DataStartRowNumber:=2, _</span><br /><span class="SHString">                        MessageBoxRequired:=False</span><br /><br /><span class="SHString">Utilities.Clear_Columns HeaderToClear:=&quot;Transition_Name&quot;, _</span><br /><span class="SHString">                        HeaderRowNumber:=1, _</span><br /><span class="SHString">                        DataStartRowNumber:=2</span></pre></div>
</div>

<a name="Clear_DotD_In_Agilent_Data_File"></a><a name="Topic95"></a><div class="CTopic TFunction LExcelVBA">
 <div class="CTitle">Clear_DotD_In_Agilent_Data_File</div>
 <div class="CBody"><pre>Public Function Clear_DotD_In_Agilent_Data_File(ByRef AgilentDataFile() As String) As String()</pre><div class="CHeading">Description</div><p>Remove the &quot;.d&quot; in the AgilentDataFile String Array.&nbsp; The Agilent files from Agilent MassHunter Quant has a &quot;Data File&quot; column which is unique in every row and is usually used as the Sample Name. The &quot;Data File&quot; column usually ends with &quot;.d&quot;. This function helps to remove this &quot;.d&quot;</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">AgilentDataFile() As String</td><td class="CDLDefinition"><p>A string array in which each entry is a data file name that ends with &quot;.d&quot;</p></td></tr></table><div class="CHeading">Returns</div><p>A string array in which each entry has &quot;.d&quot; remove</p><div class="CHeading">Examples</div><pre>Dim Sample_Name_Array(<span class="SHNumber">1</span>) As String<br /><br />Sample_Name_Array(<span class="SHNumber">0</span>) = <span class="SHString">&quot;Sample_Name_1.d&quot;</span><br />Sample_Name_Array(<span class="SHNumber">1</span>) = <span class="SHString">&quot;Sample_Name_2.d&quot;</span><br /><br />Sample_Name_Array = Utilities.Clear_DotD_In_Agilent_Data_File(Sample_Name_Array)</pre></div>
</div>

<a name="Load_Columns_From_Excel"></a><a name="Topic246"></a><div class="CTopic TFunction LExcelVBA">
 <div class="CTitle">Load_Columns_From_Excel</div>
 <div class="CBody"><pre>Public Function Load_Columns_From_Excel(ByVal HeaderName As String, _<br />                                        ByVal HeaderRowNumber As Long, _<br />                                        ByVal DataStartRowNumber As Long, _<br />                                        ByVal MessageBoxRequired As Boolean, _<br />                                        ByVal RemoveBlksAndReplicates As Boolean, _<br />                                        Optional ByVal WorksheetName As String = vbNullString, _<br />                                        Optional ByVal IgnoreHiddenRows As Boolean = True, _<br />                                        Optional ByVal IgnoreEmptyArray As Boolean = True) As String()</pre><div class="CHeading">Description</div><p>Load data from a column in Excel and put it to a string array</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">HeaderName As String</td><td class="CDLDefinition"><p>Name of the header/column to tell the system which column to output the data.</p></td></tr><tr><td class="CDLEntry">HeaderRowNumber As Long</td><td class="CDLDefinition"><p>Input integer indicating the row number where the header/column name is located.</p></td></tr><tr><td class="CDLEntry">DataStartRowNumber As Long</td><td class="CDLDefinition"><p>Input integer indicating which row to start outputing the data.</p></td></tr><tr><td class="CDLEntry">MessageBoxRequired As Boolean</td><td class="CDLDefinition"><p>If set to True, a message box will appear after loading the data saying how many entries have been loaded.</p></td></tr><tr><td class="CDLEntry">RemoveBlksAndReplicates As Boolean</td><td class="CDLDefinition"><p>If set to True, the system will remove duplicates and blank values in output string array</p></td></tr><tr><td class="CDLEntry">WorksheetName As String</td><td class="CDLDefinition"><p>Name of the worksheet to search for the header/column name. If it is blank, the active sheet will be used.</p></td></tr><tr><td class="CDLEntry">IgnoreHiddenRows As Boolean</td><td class="CDLDefinition"><p>If Cell is hidden and IgnoreHiddenRows is True, skip to the next row.</p></td></tr><tr><td class="CDLEntry">IgnoreEmptyArray As Boolean</td><td class="CDLDefinition"><p>If IgnoreEmptyArray is True, the system will end if it received an empty array as an output and will not proceed to any other process that may come after this function is utilise.</p></td></tr></table><div class="CHeading">Returns</div><p>A string array containing the loaded data</p><div class="CHeading">Examples</div><pre><span class="SHString">' Get the Lists worksheet from the active workbook</span><br /><span class="SHString">'</span> The Lists is a code name<br /><span class="SHString">' Refer to https://riptutorial.com/excel-vba/example/11272/worksheet--name---index-or--codename</span><br /><span class="SHString">Dim Lists_Worksheet As Worksheet</span><br /><br /><span class="SHString">If Utilities.Check_Sheet_Code_Name_Exists(ActiveWorkbook, &quot;Lists&quot;) = False Then</span><br /><span class="SHString">    MsgBox (&quot;Sheet Lists is missing&quot;)</span><br /><span class="SHString">    Application.EnableEvents = True</span><br /><span class="SHString">    Exit Sub</span><br /><span class="SHString">End If</span><br /><br /><span class="SHString">Set Lists_Worksheet = Utilities.Get_Sheet_By_Code_Name(ActiveWorkbook, &quot;Lists&quot;)</span><br /><br /><span class="SHString">Lists_Worksheet.Activate</span><br /><br /><span class="SHString">Dim Concentration_Unit_Array() As String</span><br /><span class="SHString">Concentration_Unit_Array = Utilities.Load_Columns_From_Excel(&quot;Concentration_Unit&quot;, HeaderRowNumber:=1, _</span><br /><span class="SHString">                                                             DataStartRowNumber:=2, MessageBoxRequired:=True, _</span><br /><span class="SHString">                                                             RemoveBlksAndReplicates:=True, _</span><br /><span class="SHString">                                                             IgnoreHiddenRows:=False, IgnoreEmptyArray:=False)</span></pre></div>
</div>

<a name="Check_Sheet_Code_Name_Exists"></a><a name="Topic247"></a><div class="CTopic TFunction LExcelVBA">
 <div class="CTitle">Check_Sheet_Code_Name_Exists</div>
 <div class="CBody"><pre>Public Function Check_Sheet_Code_Name_Exists(ByVal InputWorkbook As Workbook, _<br />                                             ByVal InputCodeName As String) As Boolean</pre><div class="CHeading">Description</div><p>Check if the sheet code name exists in this workbook</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">InputWorkbook As Workbook,</td><td class="CDLDefinition"><p>Name of the workbook to check for the code name</p></td></tr><tr><td class="CDLEntry">InputCodeName As String</td><td class="CDLDefinition"><p>Name of the code name to search in the workbook to see if it exists.</p></td></tr></table><div class="CHeading">Returns</div><p>Returns True if the code name exists. False otherwise.</p><div class="CHeading">Examples</div><pre><span class="SHString">' Should return True</span><br /><span class="SHString">Debug.Print Utilities.Check_Sheet_Code_Name_Exists(ActiveWorkbook, &quot;Lists&quot;)</span><br /><span class="SHString">'</span> Should <span class="SHKeyword">return</span> False<br />Debug.Print Utilities.Check_Sheet_Code_Name_Exists(ActiveWorkbook, <span class="SHString">&quot;Does not Exists&quot;</span>)</pre></div>
</div>

<a name="Get_Sheet_By_Code_Name"></a><a name="Topic248"></a><div class="CTopic TFunction LExcelVBA last">
 <div class="CTitle">Get_Sheet_By_Code_Name</div>
 <div class="CBody"><pre>Public Function Check_Sheet_Code_Name_Exists(ByVal InputWorkbook As Workbook, _<br />                                             ByVal InputCodeName As String) As Boolean</pre><div class="CHeading">Description</div><p>Get the name of the sheet from the sheet's code name</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">InputWorkbook As Workbook,</td><td class="CDLDefinition"><p>Name of the workbook to check for the code name</p></td></tr><tr><td class="CDLEntry">InputCodeName As String</td><td class="CDLDefinition"><p>Name of the code name to search in the workbook to see if it exists.</p></td></tr></table><div class="CHeading">Returns</div><p>Returns the name of the sheet from the sheet's code name</p><div class="CHeading">Examples</div><pre>Dim ISTD_Annot_Worksheet As Worksheet<br />Set ISTD_Annot_Worksheet = Utilities.Get_Sheet_By_Code_Name(ActiveWorkbook, <span class="SHString">&quot;ISTDAnnotSheet&quot;</span>)<br /><br /><span class="SHString">' Should be &quot;ISTDAnnotSheet&quot;</span><br /><span class="SHString">Debug.Print ISTD_Annot_Worksheet.CodeName</span></pre></div>
</div>

</body></html>