<!DOCTYPE html>

<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>Transition_Name_Annot.bas</title><link rel="stylesheet" type="text/css" href="../styles/main.css" /><script type="text/javascript" src="../styles/main.js"></script><script type="text/javascript">NDLoader.LoadJS("Content", "../styles/");</script></head>

<!-- Generated by Natural Docs, version 2.2 -->

<!-- saved from url=(0016)http://localhost -->

<body onload="NDLoader.OnLoad('Content');" class="NDPage NDContentPage">

<a name="Functions"></a><a name="Topic9"></a><div class="CTopic TGroup LVisualBasic first">
 <div class="CTitle">Functions</div>
</div>

<a name="Get_Sorted_Transition_Array_Raw"></a><a name="Topic4"></a><div class="CTopic TFunction LVisualBasic">
 <div class="CTitle">Get_Sorted_Transition_Array_Raw</div>
 <div id="NDPrototype4" class="NDPrototype WideForm"><div class="PSection PParameterSection CStyle"><table><tr><td class="PBeforeParameters">Public Function Get_Sorted_Transition_Array_Raw(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PModifierQualifier first">ByVal RawDataFiles&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName last">String</td></tr></table></td><td class="PAfterParameters">) As String()</td></tr></table></div></div>
 <div class="CBody"><div class="CHeading">Description</div><p>Get Transition Names from an input raw data file, put them into a string array and sort them in alphabetical order.</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">RawDataFiles As String</td><td class="CDLDefinition"><p>File path to a Raw Data (Agilent) File in csv.&nbsp; If multiple files are required, the different file path must be separated by &quot;;&quot; Eg. {FilePath 1};{FilePath 2}</p></td></tr></table><div class="CHeading">Returns</div><p>A string array of Transition Names sorted in alphabetical order.</p><div class="CHeading">Examples</div><pre class="CCode">Dim TestFolder As String<br />Dim RawDataFiles As String<br />Dim Transition_Array() As String<br /><br /><span class="SHComment">' Indicate path to the test data folder</span><br />TestFolder = ThisWorkbook.Path &amp; <span class="SHString">&quot;\Testdata\&quot;</span><br /><span class="SHString">RawDataFiles = TestFolder &amp; &quot;</span>AgilentRawDataTest1.csv<span class="SHString">&quot;</span><br /><br /><span class="SHString">' Get the transition names</span><br /><span class="SHString">Transition_Array = Transition_Name_Annot.Get_Sorted_Transition_Array_Raw(RawDataFiles:=RawDataFiles)</span></pre></div>
</div>

<a name="Get_Sorted_Transition_Array_Tidy"></a><a name="Topic5"></a><div class="CTopic TFunction LVisualBasic">
 <div class="CTitle">Get_Sorted_Transition_Array_Tidy</div>
 <div id="NDPrototype5" class="NDPrototype WideForm"><div class="PSection PParameterSection CStyle"><table><tr><td class="PBeforeParameters">Public Function Get_Sorted_Transition_Array_Tidy(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PModifierQualifier first">ByVal TidyDataFiles&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName last">String,</td></tr><tr><td class="PModifierQualifier first">ByVal DataFileType&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName last">String,</td></tr><tr><td class="PModifierQualifier first">ByVal TransitionProperty&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName last">String,</td></tr><tr><td class="PModifierQualifier first">ByVal StartingRowNum&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName last">Integer,</td></tr><tr><td class="PModifierQualifier first">ByVal StartingColumnNum&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName last">Integer</td></tr></table></td><td class="PAfterParameters">) As String()</td></tr></table></div></div>
 <div class="CBody"><div class="CHeading">Description</div><p>Get Transition Names from an input data file in tabular form, put them into a string array and sort them in alphabetical order.</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">TidyDataFiles As String</td><td class="CDLDefinition"><p>File path to a tabular/tidy data file.&nbsp; If multiple files are required, the different file path must be separated by &quot;;&quot; Eg. {FilePath 1};{FilePath 2}</p></td></tr><tr><td class="CDLEntry">DataFileType As String</td><td class="CDLDefinition"><p>File type of the input tabular/tidy data file</p></td></tr><tr><td class="CDLEntry">TransitionProperty As String</td><td class="CDLDefinition"><p>Choose &quot;Read as column variables&quot; if transition names are the column name.&nbsp; Choose &quot;Read as row observations&quot; if transition names are row entries.</p></td></tr><tr><td class="CDLEntry">StartingRowNum As Integer</td><td class="CDLDefinition"><p>Starting row number to read the tabular data</p></td></tr><tr><td class="CDLEntry">StartingColumnNum As Integer</td><td class="CDLDefinition"><p>Starting column number to read the tabular data</p></td></tr></table><div class="CHeading">Returns</div><p>A string array of Transition Names sorted in alphabetical order.</p><div class="CHeading">Examples</div><pre class="CCode">Dim TestFolder As String<br />Dim TidyDataRowFiles As String<br />Dim TidyDataColumnFiles As String<br />Dim Transition_Array() As String<br /><br /><span class="SHComment">' Indicate path to the test data folder</span><br />TestFolder = ThisWorkbook.Path &amp; <span class="SHString">&quot;\Testdata\&quot;</span><br /><span class="SHString">TidyDataRowFiles = TestFolder &amp; &quot;</span>TidyTransitionRow.csv<span class="SHString">&quot;</span><br /><span class="SHString">TidyDataColumnFiles = TestFolder &amp; &quot;</span>TidyTransitionColumn.csv<span class="SHString">&quot;</span><br /><br /><span class="SHString">' Get the transition names from tidy data file with transitons as column variables</span><br /><span class="SHString">Transition_Array = Transition_Name_Annot.Get_Sorted_Transition_Array_Tidy(TidyDataFiles:=TidyDataColumnFiles, _</span><br /><span class="SHString">                                                                          DataFileType:=&quot;</span>csv<span class="SHString">&quot;, _</span><br /><span class="SHString">                                                                          TransitionProperty:=&quot;</span>Read as column variables<span class="SHString">&quot;, _</span><br /><span class="SHString">                                                                          StartingRowNum:=1, _</span><br /><span class="SHString">                                                                          StartingColumnNum:=2)</span><br /><br /><span class="SHString">'Get the transition names from tidy data file with transitons as row observations</span><br /><span class="SHString">Transition_Array = Transition_Name_Annot.Get_Sorted_Transition_Array_Tidy(TidyDataFiles:=TidyDataRowFiles, _</span><br /><span class="SHString">                                                                          DataFileType:=&quot;</span>csv<span class="SHString">&quot;, _</span><br /><span class="SHString">                                                                          TransitionProperty:=&quot;</span>Read as row observations<span class="SHString">&quot;, _</span><br /><span class="SHString">                                                                          StartingRowNum:=2, _</span><br /><span class="SHString">                                                                          StartingColumnNum:=1)</span></pre></div>
</div>

<a name="Verify_ISTD"></a><a name="Topic6"></a><div class="CTopic TFunction LVisualBasic last">
 <div class="CTitle">Verify_ISTD</div>
 <div id="NDPrototype6" class="NDPrototype WideForm"><div class="PSection PParameterSection CStyle"><table><tr><td class="PBeforeParameters">Public Sub Verify_ISTD(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PModifierQualifier first">ByRef Transition_Array()&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName">String,</td><td></td><td class="last"></td></tr><tr><td class="PModifierQualifier first">ByRef ISTD_Array()&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName">String,</td><td></td><td class="last"></td></tr><tr><td class="PModifierQualifier first">Optional ByVal MessageBoxRequired&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName">Boolean</td><td class="PDefaultValueSeparator">&nbsp;=&nbsp;</td><td class="PDefaultValue last">True,</td></tr><tr><td class="PModifierQualifier first">Optional ByVal Testing&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName">Boolean</td><td class="PDefaultValueSeparator">&nbsp;=&nbsp;</td><td class="PDefaultValue last">False</td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div></div>
 <div class="CBody"><div class="CHeading">Description</div><p>Verify if the entries in column Transition_Annot_ISTD is valid.&nbsp; Input is valid if the entires can also be found in the column Transition_Annot</p><p>If input is valid, both entries in the Transition_Annot and Transition_Annot_ISTD columns will turn green</p><p>If input is empty, the entry in the Transition_Annot column will turn green while the entry in the Transition_Annot_ISTD will turn yellow</p><p>If input is in valid, both entries in the Transition_Annot and Transition_Annot_ISTD columns will turn white</p><div class="CImage"><a href="../images/Transition_Name_Annot_Verify_ISTD_Cell_Colour_Change.png" target="_blank" class="ZoomLink"><img src="../images/Transition_Name_Annot_Verify_ISTD_Cell_Colour_Change.png" loading="lazy" class="KnownDimensions" width="1774" height="176" style="max-width: 1774px" alt="Transition_Name_Annot_Verify_ISTD_Cell_Colour_Change" /></a></div><p>In addition, the following message box will appear</p><div class="CImage"><a href="../images/Transition_Name_Annot_Verify_ISTD_Invalid_ISTD_Message.png" target="_blank" class="ZoomLink"><img src="../images/Transition_Name_Annot_Verify_ISTD_Invalid_ISTD_Message.png" loading="lazy" class="KnownDimensions" width="285" height="258" style="max-width: 285px" alt="Transition_Name_Annot_Verify_ISTD_Invalid_ISTD_Message" /></a></div><p>If all entries are valid, the following message box will appear if MessageBoxRequired is set to True.</p><div class="CImage"><a href="../images/Transition_Name_Annot_Verify_ISTD_All_Valid_ISTD_Message.png" target="_blank" class="ZoomLink"><img src="../images/Transition_Name_Annot_Verify_ISTD_All_Valid_ISTD_Message.png" loading="lazy" class="KnownDimensions" width="348" height="127" style="max-width: 348px" alt="Transition_Name_Annot_Verify_ISTD_All_Valid_ISTD_Message" /></a></div><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">Transition_Array() As String</td><td class="CDLDefinition"><p>String array containing the transition names</p></td></tr><tr><td class="CDLEntry">ISTD_Array() As String</td><td class="CDLDefinition"><p>String array containing the transition name internal standard (ISTD)</p></td></tr><tr><td class="CDLEntry">MessageBoxRequired As Boolean</td><td class="CDLDefinition"><p>When set to True, the following pop up box will appear</p></td></tr></table><div class="CImage"><a href="../images/Transition_Name_Annot_Verify_ISTD_All_Valid_ISTD_Message.png" target="_blank" class="ZoomLink"><img src="../images/Transition_Name_Annot_Verify_ISTD_All_Valid_ISTD_Message.png" loading="lazy" class="KnownDimensions" width="348" height="127" style="max-width: 348px" alt="Transition_Name_Annot_Verify_ISTD_All_Valid_ISTD_Message" /></a></div><table class="CDefinitionList"><tr><td class="CDLEntry">Testing As Boolean</td><td class="CDLDefinition"><p>When set to False, after the function is used, it will exit the program as this function is meant to be run alone or as a last/final step.&nbsp; When set to True, after the function is used, it will exit the function and other functions can be called</p></td></tr></table><div class="CHeading">Examples</div><pre class="CCode"><span class="SHComment">' Get the Transition_Name_Annot worksheet from the active workbook</span><br /><span class="SHComment">' The TransitionNameAnnotSheet is a code name</span><br /><span class="SHComment">' Refer to https://riptutorial.com/excel-vba/example/11272/worksheet--name---index-or--codename</span><br />Dim Transition_Name_Annot_Worksheet As Worksheet<br /><br />If Utilities.Check_Sheet_Code_Name_Exists(ActiveWorkbook, <span class="SHString">&quot;TransitionNameAnnotSheet&quot;</span>) = False Then<br />    MsgBox (<span class="SHString">&quot;Sheet Transition_Name_Annot is missing&quot;</span>)<br />    Application.EnableEvents = True<br />    Exit Sub<br />End If<br /><br />Set Transition_Name_Annot_Worksheet = Utilities.Get_Sheet_By_Code_Name(ActiveWorkbook, <span class="SHString">&quot;TransitionNameAnnotSheet&quot;</span>)<br /><br />Transition_Name_Annot_Worksheet.Activate<br /><br />Dim Transition_Array(<span class="SHNumber">3</span>) As String<br />Transition_Array(<span class="SHNumber">0</span>) = <span class="SHString">&quot;SM 44:0&quot;</span><br />Transition_Array(<span class="SHNumber">1</span>) = <span class="SHString">&quot;SM 44:1&quot;</span><br />Transition_Array(<span class="SHNumber">2</span>) = <span class="SHString">&quot;SM 46:2&quot;</span><br />Transition_Array(<span class="SHNumber">3</span>) = <span class="SHString">&quot;SM 46:3&quot;</span><br /><br />Dim ISTD_Array(<span class="SHNumber">3</span>) As String<br />ISTD_Array(<span class="SHNumber">0</span>) = <span class="SHString">&quot;SM 44:1&quot;</span><br />ISTD_Array(<span class="SHNumber">1</span>) = <span class="SHString">&quot;SM 44:2&quot;</span><br />ISTD_Array(<span class="SHNumber">2</span>) = vbNullString<br />ISTD_Array(<span class="SHNumber">3</span>) = <span class="SHString">&quot;SM 44:1&quot;</span><br /><br />Utilities.Load_To_Excel Data_Array:=Transition_Array, _<br />                        HeaderName:=<span class="SHString">&quot;Transition_Name&quot;</span>, _<br />                        HeaderRowNumber:=<span class="SHNumber">1</span>, _<br />                        DataStartRowNumber:=<span class="SHNumber">2</span>, _<br />                        MessageBoxRequired:=False<br /><br />Utilities.Load_To_Excel Data_Array:=ISTD_Array, _<br />                        HeaderName:=<span class="SHString">&quot;Transition_Name_ISTD&quot;</span>, _<br />                        HeaderRowNumber:=<span class="SHNumber">1</span>, _<br />                        DataStartRowNumber:=<span class="SHNumber">2</span>, _<br />                        MessageBoxRequired:=False<br /><br />Transition_Name_Annot.Verify_ISTD Transition_Array:=Transition_Array, _<br />                                  ISTD_Array:=ISTD_Array, _<br />                                  MessageBoxRequired:=False, _<br />                                  Testing:=True</pre></div>
</div>

</body></html>