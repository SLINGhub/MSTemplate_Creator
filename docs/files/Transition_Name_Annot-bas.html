<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">

<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Transition_Name_Annot.bas</title><link rel="stylesheet" type="text/css" href="../styles/main.css" /><script type="text/javascript" src="../styles/main.js"></script><script type="text/javascript">NDLoader.LoadJS("Content", "../styles/");</script></head>

<!-- Generated by Natural Docs, version 2.1.1 -->

<!-- saved from url=(0016)http://localhost -->

<body onload="NDLoader.OnLoad('Content');" class="NDPage NDContentPage">

<a name="Functions"></a><a name="Topic1"></a><div class="CTopic TGroup LExcelVBA first">
 <div class="CTitle">Functions</div>
</div>

<a name="Get_Sorted_Transition_Array_Raw"></a><a name="Topic76"></a><div class="CTopic TFunction LExcelVBA">
 <div class="CTitle">Get_Sorted_Transition_Array_Raw</div>
 <div class="CBody"><pre>Public Function Get_Sorted_Transition_Array_Raw(ByRef RawDataFiles As String) As String()</pre><div class="CHeading">Description</div><p>Get Transition Names from an input raw data file, put them into a string array and sort them in alphabetical order.</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">RawDataFiles As String</td><td class="CDLDefinition"><p>File path to a Raw Data (Agilent) File in csv.&nbsp; If multiple files are required, the different file path must be separated by &quot;;&quot; Eg. {FilePath 1};{FilePath 2}</p></td></tr></table><div class="CHeading">Returns</div><p>A string array of Transition Names sorted in alphabetical order.</p><div class="CHeading">Examples</div><pre>Dim TestFolder As String<br />Dim RawDataFiles As String<br />Dim Transition_Array() As String<br /><br /><span class="SHString">' Indicate path to the test data folder</span><br /><span class="SHString">TestFolder = ThisWorkbook.Path &amp; &quot;\Testdata\&quot;</span><br /><span class="SHString">RawDataFiles = TestFolder &amp; &quot;AgilentRawDataTest1.csv&quot;</span><br /><br /><span class="SHString">'</span> Get the transition names<br />Transition_Array = Transition_Name_Annot.Get_Sorted_Transition_Array_Raw(RawDataFiles:=RawDataFiles)</pre></div>
</div>

<a name="Get_Sorted_Transition_Array_Tidy"></a><a name="Topic6"></a><div class="CTopic TFunction LExcelVBA">
 <div class="CTitle">Get_Sorted_Transition_Array_Tidy</div>
 <div class="CBody"><pre>Public Function Get_Sorted_Transition_Array_Tidy(ByRef TidyDataFiles As String, _<br />                                                 ByRef DataFileType As String, _<br />                                                 ByRef TransitionProperty As String, _<br />                                                 ByRef StartingRowNum As Integer, _<br />                                                 ByRef StartingColumnNum As Integer) As String()</pre><div class="CHeading">Description</div><p>Get Transition Names from an input data file in tabular form, put them into a string array and sort them in alphabetical order.</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">TidyDataFiles As String</td><td class="CDLDefinition"><p>File path to a tabular/tidy data file.&nbsp; If multiple files are required, the different file path must be separated by &quot;;&quot; Eg. {FilePath 1};{FilePath 2}</p></td></tr><tr><td class="CDLEntry">DataFileType As String</td><td class="CDLDefinition"><p>File type of the input tabular/tidy data file</p></td></tr><tr><td class="CDLEntry">TransitionProperty As String</td><td class="CDLDefinition"><p>Choose &quot;Read as column variables&quot; if transition names are the column name.&nbsp; Choose &quot;Read as row observations&quot; if transition names are row entries.</p></td></tr><tr><td class="CDLEntry">StartingRowNum As Integer</td><td class="CDLDefinition"><p>Starting row number to read the tabular data</p></td></tr><tr><td class="CDLEntry">StartingColumnNum As Integer</td><td class="CDLDefinition"><p>Starting column number to read the tabular data</p></td></tr></table><div class="CHeading">Returns</div><p>A string array of Transition Names sorted in alphabetical order.</p><div class="CHeading">Examples</div><pre>Dim TestFolder As String<br />Dim TidyDataRowFiles As String<br />Dim TidyDataColumnFiles As String<br />Dim Transition_Array() As String<br /><br /><span class="SHString">' Indicate path to the test data folder</span><br /><span class="SHString">TestFolder = ThisWorkbook.Path &amp; &quot;\Testdata\&quot;</span><br /><span class="SHString">TidyDataRowFiles = TestFolder &amp; &quot;TidyTransitionRow.csv&quot;</span><br /><span class="SHString">TidyDataColumnFiles = TestFolder &amp; &quot;TidyTransitionColumn.csv&quot;</span><br /><br /><span class="SHString">'</span> Get the transition names from tidy data file <span class="SHKeyword">with</span> transitons as column variables<br />Transition_Array = Transition_Name_Annot.Get_Sorted_Transition_Array_Tidy(TidyDataFiles:=TidyDataColumnFiles, _<br />                                                                          DataFileType:=<span class="SHString">&quot;csv&quot;</span>, _<br />                                                                          TransitionProperty:=<span class="SHString">&quot;Read as column variables&quot;</span>, _<br />                                                                          StartingRowNum:=<span class="SHNumber">1</span>, _<br />                                                                          StartingColumnNum:=<span class="SHNumber">2</span>)<br /><br /><span class="SHString">'Get the transition names from tidy data file with transitons as row observations</span><br /><span class="SHString">Transition_Array = Transition_Name_Annot.Get_Sorted_Transition_Array_Tidy(TidyDataFiles:=TidyDataRowFiles, _</span><br /><span class="SHString">                                                                          DataFileType:=&quot;csv&quot;, _</span><br /><span class="SHString">                                                                          TransitionProperty:=&quot;Read as row observations&quot;, _</span><br /><span class="SHString">                                                                          StartingRowNum:=2, _</span><br /><span class="SHString">                                                                          StartingColumnNum:=1)</span></pre></div>
</div>

<a name="Verify_ISTD"></a><a name="Topic53"></a><div class="CTopic TFunction LExcelVBA last">
 <div class="CTitle">Verify_ISTD</div>
 <div class="CBody"><pre>Public Sub Verify_ISTD(ByRef Transition_Array() As String, ByRef ISTD_Array() As String, _<br />                       Optional ByVal MessageBoxRequired As Boolean = True, _<br />                       Optional ByVal Testing As Boolean = False)</pre><div class="CHeading">Description</div><p>Verify if the entries in column Transition_Annot_ISTD is valid.&nbsp; Input is valid if the entires can also be found in the column Transition_Annot</p><p>If input is valid, both entries in the Transition_Annot and Transition_Annot_ISTD columns will turn green</p><p>If input is empty, the entry in the Transition_Annot column will turn green while the entry in the Transition_Annot_ISTD will turn yellow</p><p>If input is in valid, both entries in the Transition_Annot and Transition_Annot_ISTD columns will turn white</p><div class="CImage"><a href="../images/Transition_Name_Annot_Verify_ISTD_Cell_Colour_Change.png" target="_blank" class="ZoomLink"><img src="../images/Transition_Name_Annot_Verify_ISTD_Cell_Colour_Change.png" loading="lazy" class="KnownDimensions" width="1774" height="176" style="max-width: 1774px" alt="Transition_Name_Annot_Verify_ISTD_Cell_Colour_Change" /></a></div><p>In addition, the following message box will appear</p><div class="CImage"><a href="../images/Transition_Name_Annot_Verify_ISTD_Invalid_ISTD_Message.png" target="_blank" class="ZoomLink"><img src="../images/Transition_Name_Annot_Verify_ISTD_Invalid_ISTD_Message.png" loading="lazy" class="KnownDimensions" width="285" height="258" style="max-width: 285px" alt="Transition_Name_Annot_Verify_ISTD_Invalid_ISTD_Message" /></a></div><p>If all entries are valid, the following message box will appear if MessageBoxRequired is set to True.</p><div class="CImage"><a href="../images/Transition_Name_Annot_Verify_ISTD_All_Valid_ISTD_Message.png" target="_blank" class="ZoomLink"><img src="../images/Transition_Name_Annot_Verify_ISTD_All_Valid_ISTD_Message.png" loading="lazy" class="KnownDimensions" width="348" height="127" style="max-width: 348px" alt="Transition_Name_Annot_Verify_ISTD_All_Valid_ISTD_Message" /></a></div><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">Transition_Array() As String</td><td class="CDLDefinition"><p>String array containing the transition names</p></td></tr><tr><td class="CDLEntry">ISTD_Array() As String</td><td class="CDLDefinition"><p>String array containing the transition name internal standard (ISTD)</p></td></tr><tr><td class="CDLEntry">MessageBoxRequired As Boolean</td><td class="CDLDefinition"><p>When set to True, the following pop up box will appear</p></td></tr></table><div class="CImage"><a href="../images/Transition_Name_Annot_Verify_ISTD_All_Valid_ISTD_Message.png" target="_blank" class="ZoomLink"><img src="../images/Transition_Name_Annot_Verify_ISTD_All_Valid_ISTD_Message.png" loading="lazy" class="KnownDimensions" width="348" height="127" style="max-width: 348px" alt="Transition_Name_Annot_Verify_ISTD_All_Valid_ISTD_Message" /></a></div><table class="CDefinitionList"><tr><td class="CDLEntry">Testing As Boolean</td><td class="CDLDefinition"><p>When set to False, after the function is used, it will exit the program as this function is meant to be run alone or as a last/final step.&nbsp; When set to True, after the function is used, it will exit the function and other functions can be called</p></td></tr></table><div class="CHeading">Examples</div><pre><span class="SHString">' Get the Transition_Name_Annot worksheet from the active workbook</span><br /><span class="SHString">'</span> The TransitionNameAnnotSheet is a code name<br /><span class="SHString">' Refer to https://riptutorial.com/excel-vba/example/11272/worksheet--name---index-or--codename</span><br /><span class="SHString">Dim Transition_Name_Annot_Worksheet As Worksheet</span><br /><br /><span class="SHString">If Utilities.Check_Sheet_Code_Name_Exists(ActiveWorkbook, &quot;TransitionNameAnnotSheet&quot;) = False Then</span><br /><span class="SHString">    MsgBox (&quot;Sheet Transition_Name_Annot is missing&quot;)</span><br /><span class="SHString">    Application.EnableEvents = True</span><br /><span class="SHString">    Exit Sub</span><br /><span class="SHString">End If</span><br /><br /><span class="SHString">Set Transition_Name_Annot_Worksheet = Utilities.Get_Sheet_By_Code_Name(ActiveWorkbook, &quot;TransitionNameAnnotSheet&quot;)</span><br /><br /><span class="SHString">Transition_Name_Annot_Worksheet.Activate</span><br /><br /><span class="SHString">Dim Transition_Array(3) As String</span><br /><span class="SHString">Transition_Array(0) = &quot;SM 44:0&quot;</span><br /><span class="SHString">Transition_Array(1) = &quot;SM 44:1&quot;</span><br /><span class="SHString">Transition_Array(2) = &quot;SM 46:2&quot;</span><br /><span class="SHString">Transition_Array(3) = &quot;SM 46:3&quot;</span><br /><br /><span class="SHString">Dim ISTD_Array(3) As String</span><br /><span class="SHString">ISTD_Array(0) = &quot;SM 44:1&quot;</span><br /><span class="SHString">ISTD_Array(1) = &quot;SM 44:2&quot;</span><br /><span class="SHString">ISTD_Array(2) = vbNullString</span><br /><span class="SHString">ISTD_Array(3) = &quot;SM 44:1&quot;</span><br /><br /><span class="SHString">Utilities.Load_To_Excel Data_Array:=Transition_Array, _</span><br /><span class="SHString">                        HeaderName:=&quot;Transition_Name&quot;, _</span><br /><span class="SHString">                        HeaderRowNumber:=1, _</span><br /><span class="SHString">                        DataStartRowNumber:=2, _</span><br /><span class="SHString">                        MessageBoxRequired:=False</span><br /><br /><span class="SHString">Utilities.Load_To_Excel Data_Array:=ISTD_Array, _</span><br /><span class="SHString">                        HeaderName:=&quot;Transition_Name_ISTD&quot;, _</span><br /><span class="SHString">                        HeaderRowNumber:=1, _</span><br /><span class="SHString">                        DataStartRowNumber:=2, _</span><br /><span class="SHString">                        MessageBoxRequired:=False</span><br /><br /><span class="SHString">Transition_Name_Annot.Verify_ISTD Transition_Array:=Transition_Array, _</span><br /><span class="SHString">                                  ISTD_Array:=ISTD_Array, _</span><br /><span class="SHString">                                  MessageBoxRequired:=False, _</span><br /><span class="SHString">                                  Testing:=True</span></pre></div>
</div>

</body></html>