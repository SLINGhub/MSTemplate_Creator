<!DOCTYPE html>

<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>ISTD_Annot.bas</title><link rel="stylesheet" type="text/css" href="../styles/main.css" /><script type="text/javascript" src="../styles/main.js"></script><script type="text/javascript">NDLoader.LoadJS("Content", "../styles/");</script></head>

<!-- Generated by Natural Docs, version 2.2 -->

<!-- saved from url=(0016)http://localhost -->

<body onload="NDLoader.OnLoad('Content');" class="NDPage NDContentPage">

<a name="Functions"></a><a name="Topic169"></a><div class="CTopic TGroup LExcelVBA first">
 <div class="CTitle">Functions</div>
</div>

<a name="Convert_Conc_nM_Array"></a><a name="Topic170"></a><div class="CTopic TFunction LExcelVBA">
 <div class="CTitle">Convert_Conc_nM_Array</div>
 <div class="CBody"><div class="CHeading">Description</div><p>Get the concentration values from the ISTD_Conc_[nM] column and convert them based the units provided in the input Custom_Unit and output as a string array.</p><div class="CImage"><a href="../images/ISTD_Annot_ISTD_Conc_nM_Column.png" target="_blank" class="ZoomLink"><img src="../images/ISTD_Annot_ISTD_Conc_nM_Column.png" loading="lazy" class="KnownDimensions" width="144" height="68" style="max-width: 144px" alt="ISTD_Annot_ISTD_Conc_nM_Column" /></a></div><p>Currently, the accepted input for Custom_Unit are</p><ul><li><p>[M] or [umol/uL]</p></li><li><p>[mM] or [nmol/uL]</p></li><li><p>[uM] or [pmol/uL]</p></li><li><p>[nM] or [fmol/uL]</p></li><li><p>[pM] or [amol/uL]</p></li></ul><p>Any other input will still return a string array but no conversion of value.</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">Custom_Unit As String</td><td class="CDLDefinition"><p>Concentration units to be converted into.&nbsp; Accepted input are provided in the dropdown button provided by the Custom_Unit column.</p></td></tr></table><div class="CHeading">Returns</div><p>A string array of concentration converted to the provided input units.</p><div class="CHeading">Examples</div><pre class="CCode"><span class="SHString">' Get the ISTD_Annot worksheet from the active workbook</span><br /><span class="SHString">'</span> The ISTDAnnotSheet is a code name<br /><span class="SHString">' Refer to https://riptutorial.com/excel-vba/example/11272/worksheet--name---index-or--codename</span><br /><span class="SHString">Dim ISTD_Annot_Worksheet As Worksheet</span><br /><br /><span class="SHString">If Utilities.Check_Sheet_Code_Name_Exists(ActiveWorkbook, &quot;ISTDAnnotSheet&quot;) = False Then</span><br /><span class="SHString">    MsgBox (&quot;Sheet ISTD_Annot is missing&quot;)</span><br /><span class="SHString">    Application.EnableEvents = True</span><br /><span class="SHString">    Exit Sub</span><br /><span class="SHString">End If</span><br /><br /><span class="SHString">Set ISTD_Annot_Worksheet = Utilities.Get_Sheet_By_Code_Name(ActiveWorkbook, &quot;ISTDAnnotSheet&quot;)</span><br /><br /><span class="SHString">Dim ISTD_Conc_nM(2) As String</span><br /><span class="SHString">Dim ISTD_Custom_Unit() As String</span><br /><span class="SHString">Dim Custom_Unit As String</span><br /><br /><span class="SHString">ISTD_Conc_nM(0) = &quot;1000&quot;</span><br /><span class="SHString">ISTD_Conc_nM(1) = &quot;2000&quot;</span><br /><span class="SHString">ISTD_Conc_nM(2) = &quot;3000&quot;</span><br /><br /><span class="SHString">Custom_Unit = &quot;[uM] or [pmol/uL]&quot;</span><br /><br /><span class="SHString">Utilities.Load_To_Excel Data_Array:=ISTD_Conc_nM, _</span><br /><span class="SHString">                        HeaderName:=&quot;ISTD_Conc_[nM]&quot;, _</span><br /><span class="SHString">                        HeaderRowNumber:=3, _</span><br /><span class="SHString">                        DataStartRowNumber:=4, _</span><br /><span class="SHString">                        MessageBoxRequired:=False</span><br /><br /><span class="SHString">ISTD_Custom_Unit = ISTD_Annot.Convert_Conc_nM_Array(Custom_Unit:=Custom_Unit)</span></pre></div>
</div>

<a name="Get_ISTD_Conc_nM_Array"></a><a name="Topic171"></a><div class="CTopic TFunction LExcelVBA last">
 <div class="CTitle">Get_ISTD_Conc_nM_Array</div>
 <div class="CBody"><div class="CHeading">Description</div><p>Get the concentration values for the ISTD_Conc_[nM] column using the values from the ISTD_Conc_[ng/mL] and ISTD_[MW] column or from manual input from the users on the ISTD_Conc_[nM] column itself.</p><div class="CImage"><a href="../images/ISTD_Annot_ISTD_Conc_nM_Calculation_1.png" target="_blank" class="ZoomLink"><img src="../images/ISTD_Annot_ISTD_Conc_nM_Calculation_1.png" loading="lazy" class="KnownDimensions" width="791" height="485" style="max-width: 791px" alt="ISTD_Annot_ISTD_Conc_nM_Calculation_1" /></a></div><p>Output string array will be {&quot;500&quot;, &quot;100&quot;}</p><p>Calculation of ISTD_Conc_[nM] from ISTD_Conc_[ng/mL] and ISTD_[MW] is</p><p>ISTD_Conc_[nM] = ISTD_Conc_[ng/mL] / ISTD_[MW] * 1000</p><p>If all ISTD_Conc_[ng/mL], ISTD_[MW] and ISTD_Conc_[nM] column are filled the calculated concentration values from ISTD_Conc_[ng/mL] and ISTD_[MW] will take priority to avoid confusion.</p><div class="CImage"><a href="../images/ISTD_Annot_ISTD_Conc_nM_Calculation_2.png" target="_blank" class="ZoomLink"><img src="../images/ISTD_Annot_ISTD_Conc_nM_Calculation_2.png" loading="lazy" class="KnownDimensions" width="786" height="475" style="max-width: 786px" alt="ISTD_Annot_ISTD_Conc_nM_Calculation_2" /></a></div><p>Output string array will be {&quot;500&quot;, &quot;100&quot;}</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">ColourCellRequired As Boolean</td><td class="CDLDefinition"><p>If set to True, the program will also colour the cells in the ISTD_Conc_[nM] column and Custom_Unit column to green when the row has either a valid Transition_Name_ISTD, ISTD_Conc_[ng/mL] and ISTD_[MW] or a valid Transition_Name_ISTD and ISTD_Conc_[nM]</p></td></tr></table><div class="CHeading">Returns</div><p>A string array of concentration from the ISTD_Conc_[nM] column.</p><div class="CHeading">Examples</div><pre class="CCode"><span class="SHString">'We don'</span>t want excel to monitor the sheet when runnning <span class="SHKeyword">this</span> code<br />Application.EnableEvents = False<br /><br /><span class="SHString">' Get the ISTD_Annot worksheet from the active workbook</span><br /><span class="SHString">'</span> The ISTDAnnotSheet is a code name<br /><span class="SHString">' Refer to https://riptutorial.com/excel-vba/example/11272/worksheet--name---index-or--codename</span><br /><span class="SHString">Dim ISTD_Annot_Worksheet As Worksheet</span><br /><br /><span class="SHString">If Utilities.Check_Sheet_Code_Name_Exists(ActiveWorkbook, &quot;ISTDAnnotSheet&quot;) = False Then</span><br /><span class="SHString">    MsgBox (&quot;Sheet ISTD_Annot is missing&quot;)</span><br /><span class="SHString">    Application.EnableEvents = True</span><br /><span class="SHString">    Exit Sub</span><br /><span class="SHString">End If</span><br /><br /><span class="SHString">Set ISTD_Annot_Worksheet = Utilities.Get_Sheet_By_Code_Name(ActiveWorkbook, &quot;ISTDAnnotSheet&quot;)</span><br /><br /><span class="SHString">ISTD_Annot_Worksheet.Activate</span><br /><br /><span class="SHString">Dim Transition_Name_ISTD(1) As String</span><br /><span class="SHString">Dim ISTD_Conc_ng_per_mL(0) As String</span><br /><span class="SHString">Dim ISTD_Conc_MW(0) As String</span><br /><span class="SHString">Dim ISTD_Conc_nM(1) As String</span><br /><span class="SHString">Dim ISTD_Conc_nM_Results() As String</span><br /><span class="SHString">Dim ISTD_Custom_Unit_ColNumber As Integer</span><br /><span class="SHString">Dim Custom_Unit As String</span><br /><span class="SHString">Dim ISTD_Custom_Unit() As String</span><br /><br /><span class="SHString">Transition_Name_ISTD(0) = &quot;ISTD1&quot;</span><br /><span class="SHString">Transition_Name_ISTD(1) = &quot;ISTD2&quot;</span><br /><span class="SHString">ISTD_Conc_ng_per_mL(0) = &quot;1&quot;</span><br /><span class="SHString">ISTD_Conc_MW(0) = &quot;2&quot;</span><br /><span class="SHString">ISTD_Conc_nM(0) = vbNullString</span><br /><span class="SHString">ISTD_Conc_nM(1) = &quot;100&quot;</span><br /><span class="SHString">ISTD_Custom_Unit_ColNumber = Utilities.Get_Header_Col_Position(&quot;Custom_Unit&quot;, 2)</span><br /><span class="SHString">Custom_Unit = ISTD_Annot_Worksheet.Cells.Item(3, ISTD_Custom_Unit_ColNumber)</span><br /><br /><span class="SHString">Utilities.Load_To_Excel Data_Array:=Transition_Name_ISTD, _</span><br /><span class="SHString">                        HeaderName:=&quot;Transition_Name_ISTD&quot;, _</span><br /><span class="SHString">                        HeaderRowNumber:=2, _</span><br /><span class="SHString">                        DataStartRowNumber:=4, _</span><br /><span class="SHString">                        MessageBoxRequired:=False</span><br /><br /><span class="SHString">Utilities.Load_To_Excel Data_Array:=ISTD_Conc_ng_per_mL, _</span><br /><span class="SHString">                        HeaderName:=&quot;ISTD_Conc_[ng/mL]&quot;, _</span><br /><span class="SHString">                        HeaderRowNumber:=3, _</span><br /><span class="SHString">                        DataStartRowNumber:=4, _</span><br /><span class="SHString">                        MessageBoxRequired:=False</span><br /><br /><span class="SHString">Utilities.Load_To_Excel Data_Array:=ISTD_Conc_MW, _</span><br /><span class="SHString">                        HeaderName:=&quot;ISTD_[MW]&quot;, _</span><br /><span class="SHString">                        HeaderRowNumber:=3, _</span><br /><span class="SHString">                        DataStartRowNumber:=4, _</span><br /><span class="SHString">                        MessageBoxRequired:=False</span><br /><br /><span class="SHString">Utilities.Load_To_Excel Data_Array:=ISTD_Conc_nM, _</span><br /><span class="SHString">                        HeaderName:=&quot;ISTD_Conc_[nM]&quot;, _</span><br /><span class="SHString">                        HeaderRowNumber:=3, _</span><br /><span class="SHString">                        DataStartRowNumber:=4, _</span><br /><span class="SHString">                        MessageBoxRequired:=False</span><br /><br /><span class="SHString">ISTD_Conc_nM_Results = ISTD_Annot.Get_ISTD_Conc_nM_Array(ColourCellRequired:=True)</span><br /><br /><span class="SHString">Utilities.Load_To_Excel Data_Array:=ISTD_Conc_nM_Results, _</span><br /><span class="SHString">                        HeaderName:=&quot;ISTD_Conc_[nM]&quot;, _</span><br /><span class="SHString">                        HeaderRowNumber:=3, _</span><br /><span class="SHString">                        DataStartRowNumber:=4, _</span><br /><span class="SHString">                        MessageBoxRequired:=False</span><br /><br /><span class="SHString">ISTD_Custom_Unit = ISTD_Annot.Convert_Conc_nM_Array(Custom_Unit)</span><br /><br /><span class="SHString">Utilities.Load_To_Excel Data_Array:=ISTD_Custom_Unit, _</span><br /><span class="SHString">                        HeaderName:=&quot;Custom_Unit&quot;, _</span><br /><span class="SHString">                        HeaderRowNumber:=2, _</span><br /><span class="SHString">                        DataStartRowNumber:=4, _</span><br /><span class="SHString">                        MessageBoxRequired:=False</span><br /><br /><span class="SHString">Application.EnableEvents = True</span></pre></div>
</div>

</body></html>